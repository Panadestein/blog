<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-06-24 Mon 13:57 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>The Hartree-Fock program from Szabo-Ostlund</title>
<meta name="author" content="Ramón L. Panadés-Barrueta, PhD" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="../../assets/style.css"/>
</head>
<body>
<div id="content" class="content">
<h1 class="title">The Hartree-Fock program from Szabo-Ostlund</h1>
<p>
This is pretty much the original code listed in Appendix B of the legendary <a href="https://store.doverpublications.com/products/9780486691862">book</a>. It has some
minimal modifications introduced <a href="http://www.ccl.net/cca/software/SOURCES/FORTRAN/szabo/index.html">here</a>. The code was developed in <a href="https://www.math-cs.gordon.edu/courses/cs323/FORTRAN/fortran.html">Fortran IV</a> and ran in a <a href="https://en.wikipedia.org/wiki/PDP-10">PDP-10</a>.
</p>

<details>
<summary>Source code</summary>

<div class="org-src-container">
<pre class="src src-fortran" id="org8f6b4b0"><span class="org-comment-delimiter">C********************************************************************</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">MINIMAL BASIS STO-3G CALCULATION ON HEH+</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">THIS IS A LITTLE DUMMY MAIN PROGRAM WHICH CALLS HFCALC</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">APPENDIX B: TWO-ELECTRON SELF-CONSISTENT-FIELD PROGRAM</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">OF MODERN QUANTUM CHEMISTRY by</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">Attila Szabo and Neil S. Ostlund</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">Ed. 2nd (1989) Dover Publications INC.</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">Labourly Typed by Michael Zitolo (Feb., 2005)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">Edited and Compiled by Michael Zitolo and Xihua Chen</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">Cleaned up and debugged again by Andrew Long (2012) </span>
<span class="org-comment-delimiter">C                   </span><span class="org-comment">and Daniele (kalium) Dondi (2013)</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      IOP=<span class="org-highlight-numbers-number">1</span>
      N=<span class="org-highlight-numbers-number">3</span>
      R=<span class="org-highlight-numbers-number">1.4632D0</span>
      ZETA1=<span class="org-highlight-numbers-number">2.0925D0</span>
      ZETA2=<span class="org-highlight-numbers-number">1.24D0</span>
      ZA=<span class="org-highlight-numbers-number">2.0D0</span>
      ZB=<span class="org-highlight-numbers-number">1.0D0</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">HFCALC</span><span class="org-rainbow-delimiters-depth-1">(</span>IOP,N,R,ZETA1,ZETA2,ZA,ZB<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">END</span>

<span class="org-comment-delimiter">C*********************************************************************</span>
      <span class="org-keyword">SUBROUTINE</span> <span class="org-function-name">HFCALC</span><span class="org-rainbow-delimiters-depth-1">(</span>IOP,N,R,ZETA1,ZETA2,ZA,ZB<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">DOES A HARTREE-FOCK CALCULATION FOR A TWO-ELECTRON DIATOMIC</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">USING THE 1S MINIMAL STO-NG BASIS SET</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">MINIMAL BASIS SET HAS BASIS FUNCTIONS 1 AND 2 ON NUCLEI A AND B</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">IOP=0 NO PRINTING WHATSOEVER (TO OPTIMIZE EXPONENTS, SAY)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">IOP=1 PRINT ONLY CONVERGED RESULTS</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">IOP=2 PRINT EVERY ITERATION</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">N STO-NG CALCULATION (N=1,2 OR 3)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">R BONDLENGTH (AU)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">ZETA1 SLATER ORBITAL EXPONENT (FUNCTION 1)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">ZETA2 SLATER ORBITAL EXPONENT (FUNCTION 2)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">ZA ATOMIC NUMBER (ATOM A)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">ZB ATOMIC NUMBER (ATOM B)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>IOP<span class="org-keyword">.EQ.</span>0<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">20</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">10</span>,N,ZA,ZB
   <span class="org-highlight-numbers-number">10</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">' '</span>,<span class="org-highlight-numbers-number">2X</span>,<span class="org-string">'STO-'</span>,I1,<span class="org-string">'G FOR ATOMIC NUMBERS '</span>,F5.2,<span class="org-string">' AND '</span>,
     <span class="org-string">$</span> F5.2//<span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">20</span> <span class="org-keyword">CONTINUE</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CALCULATE ALL THE ONE AND TWO ELECTRON INTEGRALS</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">INTGRL</span><span class="org-rainbow-delimiters-depth-1">(</span>IOP,N,R,ZETA1,ZETA2,ZA,ZB<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">BE INEFFICIENT AND PUT ALL INTEGRALS IN PRETTY ARRAYS</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">COLECT</span><span class="org-rainbow-delimiters-depth-1">(</span>IOP,N,R,ZETA1,ZETA2,ZA,ZB<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">PERFORM THE SCF CALCULATION</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">SCF</span><span class="org-rainbow-delimiters-depth-1">(</span>IOP,N,R,ZETA1,ZETA2,ZA,ZB<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">RETURN</span>
      <span class="org-keyword">END</span>

<span class="org-comment-delimiter">C*********************************************************************</span>
      <span class="org-keyword">SUBROUTINE</span> <span class="org-function-name">INTGRL</span><span class="org-rainbow-delimiters-depth-1">(</span>IOP,N,R,ZETA1,ZETA2,ZA,ZB<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CALCULATES ALL THE BASIC INTEGRALS NEEDED FOR SCF CALCULATION</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">COMMON</span>/<span class="org-variable-name">INT</span>/S12,T11,T12,T22,V11A,V12A,V22A,V11B,V12B,V22B,
     <span class="org-string">$</span> V1111,V2111,V2121,V2211,V2221,V2222
      <span class="org-type">DIMENSION</span> <span class="org-variable-name">COEF</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">3</span>,<span class="org-highlight-numbers-number">3</span><span class="org-rainbow-delimiters-depth-1">)</span>,<span class="org-variable-name">EXPON</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">3</span>,<span class="org-highlight-numbers-number">3</span><span class="org-rainbow-delimiters-depth-1">)</span>,<span class="org-variable-name">D1</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">3</span><span class="org-rainbow-delimiters-depth-1">)</span>,<span class="org-variable-name">A1</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">3</span><span class="org-rainbow-delimiters-depth-1">)</span>,<span class="org-variable-name">D2</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">3</span><span class="org-rainbow-delimiters-depth-1">)</span>,<span class="org-variable-name">A2</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">3</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">DATA</span> <span class="org-variable-name">PI</span>/<span class="org-highlight-numbers-number">3.1415926535898D0</span>/
<span class="org-comment-delimiter">C </span><span class="org-comment">THESE ARE THE CONTRACTION COEFFICIENTS AND EXPONENTS FOR</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">A NORMALIZED SLATER ORBITAL WITH EXPONENT 1.0 IN TERMS OF</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">NORMALIZED 1S PRIMITIVE GAUSSIANS</span>
      <span class="org-type">DATA</span> <span class="org-variable-name">COEF</span>,<span class="org-variable-name">EXPON</span>/<span class="org-highlight-numbers-number">1.0D0</span>,<span class="org-highlight-numbers-number">2</span>*<span class="org-highlight-numbers-number">0.0D0</span>,<span class="org-highlight-numbers-number">0.678914D0</span>,<span class="org-highlight-numbers-number">0.430129D0</span>,<span class="org-highlight-numbers-number">0.0D0</span>,
     <span class="org-string">$</span> <span class="org-highlight-numbers-number">0.444635D0</span>,<span class="org-highlight-numbers-number">0.535328D0</span>,<span class="org-highlight-numbers-number">0.154329D0</span>,<span class="org-highlight-numbers-number">0.270950D0</span>,<span class="org-highlight-numbers-number">2</span>*<span class="org-highlight-numbers-number">0.0D0</span>,<span class="org-highlight-numbers-number">0.151623D0</span>,
     <span class="org-string">$</span> <span class="org-highlight-numbers-number">0.851819D0</span>,<span class="org-highlight-numbers-number">0.0D0</span>,<span class="org-highlight-numbers-number">0.109818D0</span>,<span class="org-highlight-numbers-number">0.405771D0</span>,<span class="org-highlight-numbers-number">2.22766D0</span>/
      R2=R*R
<span class="org-comment-delimiter">C </span><span class="org-comment">SCALE THE EXPONENTS (A) OF PRIMITIVE GAUSSIANS</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">INCLUDE NORMALIZATION IN CONTRACTION COEFFICIENTS (D)</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">10</span> I=<span class="org-highlight-numbers-number">1</span>,N
      A1<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>=EXPON<span class="org-rainbow-delimiters-depth-1">(</span>I,N<span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-rainbow-delimiters-depth-1">(</span>ZETA1**<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
      D1<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>=COEF<span class="org-rainbow-delimiters-depth-1">(</span>I,N<span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-highlight-numbers-number">2.0D0</span>*A1<span class="org-rainbow-delimiters-depth-3">(</span>I<span class="org-rainbow-delimiters-depth-3">)</span>/PI<span class="org-rainbow-delimiters-depth-2">)</span>**<span class="org-highlight-numbers-number">0.75D0</span><span class="org-rainbow-delimiters-depth-1">)</span>
      A2<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>=EXPON<span class="org-rainbow-delimiters-depth-1">(</span>I,N<span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-rainbow-delimiters-depth-1">(</span>ZETA2**<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
      D2<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>=COEF<span class="org-rainbow-delimiters-depth-1">(</span>I,N<span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-highlight-numbers-number">2.0D0</span>*A2<span class="org-rainbow-delimiters-depth-3">(</span>I<span class="org-rainbow-delimiters-depth-3">)</span>/PI<span class="org-rainbow-delimiters-depth-2">)</span>**<span class="org-highlight-numbers-number">0.75D0</span><span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">10</span> <span class="org-keyword">CONTINUE</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">D AND A ARE NOW THE CONTRACTION COEFFICIENTS AND EXPONENTS</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">IN TERMS OF UNNORMALIZED PRIMITIVE GAUSSIANS</span>
      S12=<span class="org-highlight-numbers-number">0.0D0</span>
      T11=<span class="org-highlight-numbers-number">0.0D0</span>
      T12=<span class="org-highlight-numbers-number">0.0D0</span>
      T22=<span class="org-highlight-numbers-number">0.0D0</span>
      V11A=<span class="org-highlight-numbers-number">0.0D0</span>
      V12A=<span class="org-highlight-numbers-number">0.0D0</span>
      V22A=<span class="org-highlight-numbers-number">0.0D0</span>
      V11B=<span class="org-highlight-numbers-number">0.0D0</span>
      V12B=<span class="org-highlight-numbers-number">0.0D0</span>
      V22B=<span class="org-highlight-numbers-number">0.0D0</span>
      V1111=<span class="org-highlight-numbers-number">0.0D0</span>
      V2111=<span class="org-highlight-numbers-number">0.0D0</span>
      V2121=<span class="org-highlight-numbers-number">0.0D0</span>
      V2211=<span class="org-highlight-numbers-number">0.0D0</span>
      V2221=<span class="org-highlight-numbers-number">0.0D0</span>
      V2222=<span class="org-highlight-numbers-number">0.0D0</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CALCULATE ONE-ELECTRON INTEGRALS</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CENTER A IS FIRST ATOM, CETER B IS SECOND ATOM</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">ORIGIN IS ON CENTER A</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">V12A = OFF-DIAGONAL NUCLEAR ATTRACTION TO CENTER A, ETC.</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">20</span> I=<span class="org-highlight-numbers-number">1</span>,N
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">20</span> J=<span class="org-highlight-numbers-number">1</span>,N
<span class="org-comment-delimiter">C </span><span class="org-comment">RAP2 = SQUARED DISTANCE BETWEEN CENTER A AND CENTER P, ETC.</span>
      RAP=A2<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>*R/<span class="org-rainbow-delimiters-depth-1">(</span>A1<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>+A2<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
      RAP2=RAP**<span class="org-highlight-numbers-number">2</span>
      RBP2=<span class="org-rainbow-delimiters-depth-1">(</span>R-RAP<span class="org-rainbow-delimiters-depth-1">)</span>**<span class="org-highlight-numbers-number">2</span>
      S12=S12+S<span class="org-rainbow-delimiters-depth-1">(</span>A1<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A2<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,R2<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>
      T11=T11+T<span class="org-rainbow-delimiters-depth-1">(</span>A1<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A1<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,<span class="org-highlight-numbers-number">0.0D0</span><span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>
      T12=T12+T<span class="org-rainbow-delimiters-depth-1">(</span>A1<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A2<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,R2<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>
      T22=T22+T<span class="org-rainbow-delimiters-depth-1">(</span>A2<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A2<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,<span class="org-highlight-numbers-number">0.0D0</span><span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>
      V11A=V11A+V<span class="org-rainbow-delimiters-depth-1">(</span>A1<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A1<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,<span class="org-highlight-numbers-number">0.0D0</span>,<span class="org-highlight-numbers-number">0.0D0</span>,ZA<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>
      V12A=V12A+V<span class="org-rainbow-delimiters-depth-1">(</span>A1<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A2<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,R2,RAP2,ZA<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>
      V22A=V22A+V<span class="org-rainbow-delimiters-depth-1">(</span>A2<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A2<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,<span class="org-highlight-numbers-number">0.0D0</span>,R2,ZA<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>
      V11B=V11B+V<span class="org-rainbow-delimiters-depth-1">(</span>A1<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A1<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,<span class="org-highlight-numbers-number">0.0D0</span>,R2,ZB<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>
      V12B=V12B+V<span class="org-rainbow-delimiters-depth-1">(</span>A1<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A2<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,R2,RBP2,ZB<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>
      V22B=V22B+V<span class="org-rainbow-delimiters-depth-1">(</span>A2<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A2<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,<span class="org-highlight-numbers-number">0.0D0</span>,<span class="org-highlight-numbers-number">0.0D0</span>,ZB<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">20</span> <span class="org-keyword">CONTINUE</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CALCULATE TWO-ELECTRON INTEGRALS</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">30</span> I=<span class="org-highlight-numbers-number">1</span>,N
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">30</span> J=<span class="org-highlight-numbers-number">1</span>,N
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">30</span> K=<span class="org-highlight-numbers-number">1</span>,N
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">30</span> L=<span class="org-highlight-numbers-number">1</span>,N
      RAP=A2<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*R/<span class="org-rainbow-delimiters-depth-1">(</span>A2<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>+A1<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
      RBP=R-RAP
      RAQ=A2<span class="org-rainbow-delimiters-depth-1">(</span>K<span class="org-rainbow-delimiters-depth-1">)</span>*R/<span class="org-rainbow-delimiters-depth-1">(</span>A2<span class="org-rainbow-delimiters-depth-2">(</span>K<span class="org-rainbow-delimiters-depth-2">)</span>+A1<span class="org-rainbow-delimiters-depth-2">(</span>L<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
      RBQ=R-RAQ
      RPQ=RAP-RAQ
      RAP2=RAP*RAP
      RBP2=RBP*RBP
      RAQ2=RAQ*RAQ
      RBQ2=RBQ*RBQ
      RPQ2=RPQ*RPQ
      V1111=V1111+TWOE<span class="org-rainbow-delimiters-depth-1">(</span>A1<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A1<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,A1<span class="org-rainbow-delimiters-depth-2">(</span>K<span class="org-rainbow-delimiters-depth-2">)</span>,A1<span class="org-rainbow-delimiters-depth-2">(</span>L<span class="org-rainbow-delimiters-depth-2">)</span>,<span class="org-highlight-numbers-number">0.0D0</span>,<span class="org-highlight-numbers-number">0.0D0</span>,<span class="org-highlight-numbers-number">0.0D0</span><span class="org-rainbow-delimiters-depth-1">)</span>
     <span class="org-string">$</span> *D1<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>K<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>L<span class="org-rainbow-delimiters-depth-1">)</span>
      V2111=V2111+TWOE<span class="org-rainbow-delimiters-depth-1">(</span>A2<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A1<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,A1<span class="org-rainbow-delimiters-depth-2">(</span>K<span class="org-rainbow-delimiters-depth-2">)</span>,A1<span class="org-rainbow-delimiters-depth-2">(</span>L<span class="org-rainbow-delimiters-depth-2">)</span>,R2,<span class="org-highlight-numbers-number">0.0D0</span>,RAP2<span class="org-rainbow-delimiters-depth-1">)</span>
     <span class="org-string">$</span> *D2<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>K<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>L<span class="org-rainbow-delimiters-depth-1">)</span>
      V2121=V2121+TWOE<span class="org-rainbow-delimiters-depth-1">(</span>A2<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A1<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,A2<span class="org-rainbow-delimiters-depth-2">(</span>K<span class="org-rainbow-delimiters-depth-2">)</span>,A1<span class="org-rainbow-delimiters-depth-2">(</span>L<span class="org-rainbow-delimiters-depth-2">)</span>,R2,R2,RPQ2<span class="org-rainbow-delimiters-depth-1">)</span>
     <span class="org-string">$</span> *D2<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>K<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>L<span class="org-rainbow-delimiters-depth-1">)</span>
      V2211=V2211+TWOE<span class="org-rainbow-delimiters-depth-1">(</span>A2<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A2<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,A1<span class="org-rainbow-delimiters-depth-2">(</span>K<span class="org-rainbow-delimiters-depth-2">)</span>,A1<span class="org-rainbow-delimiters-depth-2">(</span>L<span class="org-rainbow-delimiters-depth-2">)</span>,<span class="org-highlight-numbers-number">0.0D0</span>,<span class="org-highlight-numbers-number">0.0D0</span>,R2<span class="org-rainbow-delimiters-depth-1">)</span>
     <span class="org-string">$</span> *D2<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>K<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>L<span class="org-rainbow-delimiters-depth-1">)</span>
      V2221=V2221+TWOE<span class="org-rainbow-delimiters-depth-1">(</span>A2<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A2<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,A2<span class="org-rainbow-delimiters-depth-2">(</span>K<span class="org-rainbow-delimiters-depth-2">)</span>,A1<span class="org-rainbow-delimiters-depth-2">(</span>L<span class="org-rainbow-delimiters-depth-2">)</span>,<span class="org-highlight-numbers-number">0.0D0</span>,R2,RBQ2<span class="org-rainbow-delimiters-depth-1">)</span>
     <span class="org-string">$</span> *D2<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>K<span class="org-rainbow-delimiters-depth-1">)</span>*D1<span class="org-rainbow-delimiters-depth-1">(</span>L<span class="org-rainbow-delimiters-depth-1">)</span>
      V2222=V2222+TWOE<span class="org-rainbow-delimiters-depth-1">(</span>A2<span class="org-rainbow-delimiters-depth-2">(</span>I<span class="org-rainbow-delimiters-depth-2">)</span>,A2<span class="org-rainbow-delimiters-depth-2">(</span>J<span class="org-rainbow-delimiters-depth-2">)</span>,A2<span class="org-rainbow-delimiters-depth-2">(</span>K<span class="org-rainbow-delimiters-depth-2">)</span>,A2<span class="org-rainbow-delimiters-depth-2">(</span>L<span class="org-rainbow-delimiters-depth-2">)</span>,<span class="org-highlight-numbers-number">0.0D0</span>,<span class="org-highlight-numbers-number">0.0D0</span>,<span class="org-highlight-numbers-number">0.0D0</span><span class="org-rainbow-delimiters-depth-1">)</span>
     <span class="org-string">$</span> *D2<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>J<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>K<span class="org-rainbow-delimiters-depth-1">)</span>*D2<span class="org-rainbow-delimiters-depth-1">(</span>L<span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">30</span> <span class="org-keyword">CONTINUE</span>
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>IOP<span class="org-keyword">.EQ.</span>0<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">90</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">40</span>
   <span class="org-highlight-numbers-number">40</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">3X</span>,<span class="org-string">'R'</span>,<span class="org-highlight-numbers-number">10X</span>,<span class="org-string">'ZETA1'</span>,<span class="org-highlight-numbers-number">6X</span>,<span class="org-string">'ZETA2'</span>,<span class="org-highlight-numbers-number">6X</span>,<span class="org-string">'S12'</span>,<span class="org-highlight-numbers-number">8X</span>,<span class="org-string">'T11'</span>/<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">50</span>, R,ZETA1,ZETA2,S12,T11
   <span class="org-highlight-numbers-number">50</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">5F11.6</span>//<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">60</span>
   <span class="org-highlight-numbers-number">60</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">3X</span>,<span class="org-string">'T12'</span>,<span class="org-highlight-numbers-number">8X</span>,<span class="org-string">'T22'</span>,<span class="org-highlight-numbers-number">8X</span>,<span class="org-string">'V11A'</span>,<span class="org-highlight-numbers-number">7X</span>,<span class="org-string">'V12A'</span>,<span class="org-highlight-numbers-number">7X</span>,<span class="org-string">'V22A'</span>/<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">50</span>, T12,T22,V11A,V12A,V22A
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">70</span>
   <span class="org-highlight-numbers-number">70</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">3X</span>,<span class="org-highlight-numbers-number">4HV11B</span>,<span class="org-highlight-numbers-number">7X</span>,<span class="org-highlight-numbers-number">4HV12B</span>,<span class="org-highlight-numbers-number">7X</span>,<span class="org-highlight-numbers-number">4HV22B</span>,<span class="org-highlight-numbers-number">7X</span>,<span class="org-string">'V1111'</span>,<span class="org-highlight-numbers-number">6X</span>,<span class="org-string">'V2111'</span>/<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">50</span>, V11B,V12B,V22B,V1111,V2111
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">80</span>
   <span class="org-highlight-numbers-number">80</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">3X</span>,<span class="org-highlight-numbers-number">5HV2121</span>,<span class="org-highlight-numbers-number">6X</span>,<span class="org-highlight-numbers-number">5HV2211</span>,<span class="org-highlight-numbers-number">6X</span>,<span class="org-highlight-numbers-number">5HV2221</span>,<span class="org-highlight-numbers-number">6X</span>,<span class="org-highlight-numbers-number">5HV2222</span>/<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">50</span>, V2121,V2211,V2221,V2222
   <span class="org-highlight-numbers-number">90</span> <span class="org-keyword">RETURN</span>
      <span class="org-keyword">END</span>

<span class="org-comment-delimiter">C*********************************************************************</span>
      <span class="org-keyword">FUNCTION</span> <span class="org-function-name">F0</span><span class="org-rainbow-delimiters-depth-1">(</span>ARG<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CALCULATES THE F FUNCTION</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">FO ONLY (S-TYPE ORBITALS)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">DATA</span> <span class="org-variable-name">PI</span>/<span class="org-highlight-numbers-number">3.1415926535898D0</span>/
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>ARG<span class="org-keyword">.LT.</span>1.0D-<span class="org-highlight-numbers-number">6</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">10</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">F0 IN TERMS OF THE ERROR FUNCTION</span>
      F0=<span class="org-builtin">DSQRT</span><span class="org-rainbow-delimiters-depth-1">(</span>PI/ARG<span class="org-rainbow-delimiters-depth-1">)</span>*DERFOTHER<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-builtin">DSQRT</span><span class="org-rainbow-delimiters-depth-2">(</span>ARG<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>/<span class="org-highlight-numbers-number">2.0D0</span>
      <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">20</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">ASYMPTOTIC VALUE FOR SMALL ARGUMENTS</span>
   <span class="org-highlight-numbers-number">10</span> F0=<span class="org-highlight-numbers-number">1.0D0</span>-ARG/<span class="org-highlight-numbers-number">3.0D0</span>
   <span class="org-highlight-numbers-number">20</span> <span class="org-keyword">CONTINUE</span>
      <span class="org-keyword">RETURN</span>
      <span class="org-keyword">END</span>

<span class="org-comment-delimiter">C*********************************************************************</span>
      <span class="org-keyword">FUNCTION</span> <span class="org-function-name">DERFOTHER</span><span class="org-rainbow-delimiters-depth-1">(</span>ARG<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CALCULATES THE ERROR FUNCTION ACCORDING TO A RATIONAL</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">APPROXIMATION FROM M. ARBRAMOWITZ AND I.A. STEGUN,</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">HANDBOOK OF MATHEMATICAL FUNCTIONS, DOVER.</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">ABSOLUTE ERROR IS LESS THAN 1.5*10**(-7)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CAN BE REPLACED BY A BUILT-IN FUNCTION ON SOME MACHINES</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">DIMENSION</span> <span class="org-variable-name">A</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">5</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">DATA</span> <span class="org-variable-name">P</span>/<span class="org-highlight-numbers-number">0.3275911D0</span>/
      <span class="org-type">DATA</span> <span class="org-variable-name">A</span>/<span class="org-highlight-numbers-number">0.254829592D0</span>,-<span class="org-highlight-numbers-number">0.284496736D0</span>,<span class="org-highlight-numbers-number">1.421413741D0</span>,
     <span class="org-string">$</span> -<span class="org-highlight-numbers-number">1.453152027D0</span>,<span class="org-highlight-numbers-number">1.061405429D0</span>/
      T=<span class="org-highlight-numbers-number">1.0D0</span>/<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1.0D0</span>+P*ARG<span class="org-rainbow-delimiters-depth-1">)</span>
      TN=T
      POLY=A<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>*TN
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">10</span> I=<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">5</span>
      TN=TN*T
      POLY=POLY+A<span class="org-rainbow-delimiters-depth-1">(</span>I<span class="org-rainbow-delimiters-depth-1">)</span>*TN
   <span class="org-highlight-numbers-number">10</span> <span class="org-keyword">CONTINUE</span>
      DERFOTHER=<span class="org-highlight-numbers-number">1.0D0</span>-POLY*<span class="org-builtin">DEXP</span><span class="org-rainbow-delimiters-depth-1">(</span>-ARG*ARG<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">RETURN</span>
      <span class="org-keyword">END</span>

<span class="org-comment-delimiter">C*********************************************************************</span>
      <span class="org-keyword">FUNCTION</span> <span class="org-function-name">S</span><span class="org-rainbow-delimiters-depth-1">(</span>A,B,RAB2<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CALCULATES OVERLAPS FOR UN-NORMALIZED PRIMITIVES</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">DATA</span> <span class="org-variable-name">PI</span>/<span class="org-highlight-numbers-number">3.1415926535898D0</span>/
      S=<span class="org-rainbow-delimiters-depth-1">(</span>PI/<span class="org-rainbow-delimiters-depth-2">(</span>A+B<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>**<span class="org-highlight-numbers-number">1.5D0</span>*<span class="org-builtin">DEXP</span><span class="org-rainbow-delimiters-depth-1">(</span>-A*B*RAB2/<span class="org-rainbow-delimiters-depth-2">(</span>A+B<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">RETURN</span>
      <span class="org-keyword">END</span>

<span class="org-comment-delimiter">C*********************************************************************</span>
      <span class="org-keyword">FUNCTION</span> <span class="org-function-name">T</span><span class="org-rainbow-delimiters-depth-1">(</span>A,B,RAB2<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CALCULATES KINETIC ENERGY INTEGRALS FOR UN-NORMALIZED PRIMITIVES</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">DATA</span> <span class="org-variable-name">PI</span>/<span class="org-highlight-numbers-number">3.1415926535898D0</span>/
      T=A*B/<span class="org-rainbow-delimiters-depth-1">(</span>A+B<span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">3.0D0</span>-<span class="org-highlight-numbers-number">2.0D0</span>*A*B*RAB2/<span class="org-rainbow-delimiters-depth-2">(</span>A+B<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-rainbow-delimiters-depth-1">(</span>PI/<span class="org-rainbow-delimiters-depth-2">(</span>A+B<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>**<span class="org-highlight-numbers-number">1.5D0</span>
     <span class="org-string">$</span> *<span class="org-builtin">DEXP</span><span class="org-rainbow-delimiters-depth-1">(</span>-A*B*RAB2/<span class="org-rainbow-delimiters-depth-2">(</span>A+B<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">RETURN</span>
      <span class="org-keyword">END</span>

<span class="org-comment-delimiter">C*********************************************************************</span>
      <span class="org-keyword">FUNCTION</span> <span class="org-function-name">V</span><span class="org-rainbow-delimiters-depth-1">(</span>A,B,RAB2,RCP2,ZC<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CALCULATES UN-NORMALIZED NUCLEAR ATTRACTION INTEGRALS</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">DATA</span> <span class="org-variable-name">PI</span>/<span class="org-highlight-numbers-number">3.1415926535898D0</span>/
      V=<span class="org-highlight-numbers-number">2.0D0</span>*PI/<span class="org-rainbow-delimiters-depth-1">(</span>A+B<span class="org-rainbow-delimiters-depth-1">)</span>*F0<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">(</span>A+B<span class="org-rainbow-delimiters-depth-2">)</span>*RCP2<span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-builtin">DEXP</span><span class="org-rainbow-delimiters-depth-1">(</span>-A*B*RAB2/<span class="org-rainbow-delimiters-depth-2">(</span>A+B<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
      V=-V*ZC
      <span class="org-keyword">RETURN</span>
      <span class="org-keyword">END</span>

<span class="org-comment-delimiter">C*********************************************************************</span>
      <span class="org-keyword">FUNCTION</span> <span class="org-function-name">TWOE</span><span class="org-rainbow-delimiters-depth-1">(</span>A,B,C,D,RAB2,RCD2,RPQ2<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CALCULATES TWO-ELECTRON INTEGRALS FOR UN-NORMALIZED PRIMITIVES</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">A,B,C,D ARE THE EXPONENTS ALPHA, BETA, ETC.</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">RAB2 EQUALS SQUARED DISTANCE BETWEEN CENTER A AND CENTER B, ETC.</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">DATA</span> <span class="org-variable-name">PI</span>/<span class="org-highlight-numbers-number">3.1415926535898D0</span>/
      TWOE=<span class="org-highlight-numbers-number">2.0D0</span>*<span class="org-rainbow-delimiters-depth-1">(</span>PI**<span class="org-highlight-numbers-number">2.5D0</span><span class="org-rainbow-delimiters-depth-1">)</span>/<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">(</span>A+B<span class="org-rainbow-delimiters-depth-2">)</span>*<span class="org-rainbow-delimiters-depth-2">(</span>C+D<span class="org-rainbow-delimiters-depth-2">)</span>*<span class="org-builtin">DSQRT</span><span class="org-rainbow-delimiters-depth-2">(</span>A+B+C+D<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
     <span class="org-string">$</span> *F0<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">(</span>A+B<span class="org-rainbow-delimiters-depth-2">)</span>*<span class="org-rainbow-delimiters-depth-2">(</span>C+D<span class="org-rainbow-delimiters-depth-2">)</span>*RPQ2/<span class="org-rainbow-delimiters-depth-2">(</span>A+B+C+D<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
     <span class="org-string">$</span> *<span class="org-builtin">DEXP</span><span class="org-rainbow-delimiters-depth-1">(</span>-A*B*RAB2/<span class="org-rainbow-delimiters-depth-2">(</span>A+B<span class="org-rainbow-delimiters-depth-2">)</span>-C*D*RCD2/<span class="org-rainbow-delimiters-depth-2">(</span>C+D<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">RETURN</span>
      <span class="org-keyword">END</span>

<span class="org-comment-delimiter">C*********************************************************************</span>
      <span class="org-keyword">SUBROUTINE</span> <span class="org-function-name">COLECT</span><span class="org-rainbow-delimiters-depth-1">(</span>IOP,N,R,ZETA1,ZETA2,ZA,ZB<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">THIS TAKES THE BASIC INTEGRALS FROM COMMON AND ASSEMBLES THE</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">RELEVENT MATRICES, THAT IS S,H,X,XT, AND TWO-ELECTRON INTEGRALS</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">COMMON</span>/<span class="org-variable-name">MATRIX</span>/S<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,X<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,XT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,H<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,F<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,G<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,
     <span class="org-string">$</span> FPRIME<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,CPRIME<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,P<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,OLDP<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,E<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">COMMON</span>/<span class="org-variable-name">INT</span>/S12,T11,T12,T22,V11A,V12A,V22A,V11B,V12B,V22B,
     <span class="org-string">$</span> V1111,V2111,V2121,V2211,V2221,V2222
<span class="org-comment-delimiter">C </span><span class="org-comment">FORM CORE HAMILTONIAN</span>
      H<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=T11+V11A+V11B
      H<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=T12+V12A+V12B
      H<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=H<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
      H<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=T22+V22A+V22B
<span class="org-comment-delimiter">C </span><span class="org-comment">FORM OVERLAP MATRIX</span>
      S<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=<span class="org-highlight-numbers-number">1.0D0</span>
      S<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=S12
      S<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=S<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
      S<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=<span class="org-highlight-numbers-number">1.0D0</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">USE CANONICAL ORTHOGONALIZATION</span>
      X<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=<span class="org-highlight-numbers-number">1.0D0</span>/<span class="org-builtin">DSQRT</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2.0D0</span>*<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-highlight-numbers-number">1.0D0</span>+S12<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
      X<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=X<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>
      X<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=<span class="org-highlight-numbers-number">1.0D0</span>/<span class="org-builtin">DSQRT</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2.0D0</span>*<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-highlight-numbers-number">1.0D0</span>-S12<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
      X<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=-X<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">TRANSPOSE OF TRANSFORMATION MATRIX</span>
      XT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=X<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>
      XT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=X<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>
      XT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=X<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
      XT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=X<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">MATRIX OF TWO-ELE&#65533;CTRON INTEGRALS</span>
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=V1111
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2111
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2111
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2111
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2111
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2121
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2121
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2121
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2121
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2211
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2211
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2221
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2221
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2221
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2221
      TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=V2222
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>IOP<span class="org-keyword">.EQ.</span>0<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">40</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>S,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">4HS</span>   <span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>X,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">4HX</span>   <span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>H,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">4HH</span>   <span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">10</span>
   <span class="org-highlight-numbers-number">10</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span>//<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">30</span> I=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">30</span> J=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">30</span> K=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">30</span> L=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">20</span>, I,J,K,L,TT<span class="org-rainbow-delimiters-depth-1">(</span>I,J,K,L<span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">20</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">3X</span>,<span class="org-highlight-numbers-number">1H</span><span class="org-rainbow-delimiters-depth-2">(</span>,<span class="org-highlight-numbers-number">4I2</span>,<span class="org-highlight-numbers-number">2H</span> <span class="org-rainbow-delimiters-depth-2">)</span>,F10.6<span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">30</span> <span class="org-keyword">CONTINUE</span>
   <span class="org-highlight-numbers-number">40</span> <span class="org-keyword">RETURN</span>
      <span class="org-keyword">END</span>

<span class="org-comment-delimiter">C*********************************************************************</span>
      <span class="org-keyword">SUBROUTINE</span> <span class="org-function-name">SCF</span><span class="org-rainbow-delimiters-depth-1">(</span>IOP,N,R,ZETA1,ZETA2,ZA,ZB<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">PERFORMS THE SCF ITERATIONS</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">COMMON</span>/<span class="org-variable-name">MATRIX</span>/S<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,X<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,XT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,H<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,F<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,G<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,
     <span class="org-string">$</span> FPRIME<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,CPRIME<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,P<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,OLDP<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,E<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">DATA</span> <span class="org-variable-name">PI</span>/<span class="org-highlight-numbers-number">3.1415926535898D0</span>/
<span class="org-comment-delimiter">C </span><span class="org-comment">CONVERGENCE CRITERION FOR DENSITY MATRIX</span>
      <span class="org-type">DATA</span> <span class="org-variable-name">CRIT</span>/<span class="org-highlight-numbers-number">1.0D</span>-<span class="org-highlight-numbers-number">4</span>/
<span class="org-comment-delimiter">C </span><span class="org-comment">MAXIMUM NUMBER OF ITERATIONS</span>
      <span class="org-type">DATA</span> <span class="org-variable-name">MAXIT</span>/<span class="org-highlight-numbers-number">25</span>/
<span class="org-comment-delimiter">C </span><span class="org-comment">ITERATION NUMBER</span>
      ITER=<span class="org-highlight-numbers-number">0</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">USE CORE-HAMILTONIAN FOR INITIAL GUESS AT F, I.E. (P=0)</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">10</span> I=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">10</span> J=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
   <span class="org-highlight-numbers-number">10</span> P<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>=<span class="org-highlight-numbers-number">0.0D0</span>
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>IOP<span class="org-keyword">.LT.</span>2<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">20</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>P,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">4HP</span>   <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">START OF ITERATION LOOP</span>
   <span class="org-highlight-numbers-number">20</span> ITER=ITER+<span class="org-highlight-numbers-number">1</span>
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>IOP<span class="org-keyword">.LT.</span>2<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">40</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">30</span>, ITER
   <span class="org-highlight-numbers-number">30</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span>/,<span class="org-highlight-numbers-number">4X</span>,<span class="org-highlight-numbers-number">28HSTART</span> OF ITERATION NUMBER = ,I2<span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">40</span> <span class="org-keyword">CONTINUE</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">FORM TWO-ELECTRON PART OF FOCK MATRIX FROM P</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">FORMG</span>
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>IOP<span class="org-keyword">.LT.</span>2<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">50</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>G,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">4HG</span>   <span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">50</span> <span class="org-keyword">CONTINUE</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">ADD CORE HAMILTONIAN TO GET FOCK MATRIX</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">60</span> I=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">60</span> J=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      F<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span> = H<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>+G<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">60</span> <span class="org-keyword">CONTINUE</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CALCULATE ELECTRONIC ENERGY</span>
      EN=<span class="org-highlight-numbers-number">0.0D0</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">70</span> I=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">70</span> J=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      EN=EN+<span class="org-highlight-numbers-number">0.5D0</span>*P<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-rainbow-delimiters-depth-1">(</span>H<span class="org-rainbow-delimiters-depth-2">(</span>I,J<span class="org-rainbow-delimiters-depth-2">)</span>+F<span class="org-rainbow-delimiters-depth-2">(</span>I,J<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">70</span> <span class="org-keyword">CONTINUE</span>
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>IOP<span class="org-keyword">.LT.</span>2<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">90</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>F,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">4HF</span>   <span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">80</span>, EN
   <span class="org-highlight-numbers-number">80</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span>///,<span class="org-highlight-numbers-number">4X</span>,<span class="org-highlight-numbers-number">20HELECTRONIC</span> ENERGY = ,D20.12<span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">90</span> <span class="org-keyword">CONTINUE</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">TRANSFORM FOCK MATRIX USING G FOR TEMPORARY STORAGE</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MULT</span><span class="org-rainbow-delimiters-depth-1">(</span>F,X,G,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MULT</span><span class="org-rainbow-delimiters-depth-1">(</span>XT,G,FPRIME,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">DIAGONALIZE TRANSFORMED FOCK MATRIX</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">DIAG</span><span class="org-rainbow-delimiters-depth-1">(</span>FPRIME,CPRIME,E<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">TRANSFORM EIGENVECTORS TO GET MATRIX C</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MULT</span><span class="org-rainbow-delimiters-depth-1">(</span>X,CPRIME,C,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">FORM NEW DENSITY MATRIX</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">100</span> I=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">100</span> J=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">SAVE PRESENT DENSITY MATRIX</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">BEFORE CREATING NEW ONE</span>
      OLDP<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>=P<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>
      P<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>=<span class="org-highlight-numbers-number">0.0D0</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">100</span> K=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span>
      P<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>=P<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>+<span class="org-highlight-numbers-number">2.0D0</span>*C<span class="org-rainbow-delimiters-depth-1">(</span>I,K<span class="org-rainbow-delimiters-depth-1">)</span>*C<span class="org-rainbow-delimiters-depth-1">(</span>J,K<span class="org-rainbow-delimiters-depth-1">)</span>
  <span class="org-highlight-numbers-number">100</span> <span class="org-keyword">CONTINUE</span>
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>IOP<span class="org-keyword">.LT.</span>2<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">110</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>FPRIME,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-string">"F'  "</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>CPRIME,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-string">"C'  "</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>E,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-string">'E   '</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>C,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-string">'C   '</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>P,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-string">'P   '</span><span class="org-rainbow-delimiters-depth-1">)</span>
  <span class="org-highlight-numbers-number">110</span> <span class="org-keyword">CONTINUE</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CALCULATE DELTA</span>
      DELTA=<span class="org-highlight-numbers-number">0.0D0</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">120</span> I=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">120</span> J=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      DELTA=DELTA+<span class="org-rainbow-delimiters-depth-1">(</span>P<span class="org-rainbow-delimiters-depth-2">(</span>I,J<span class="org-rainbow-delimiters-depth-2">)</span>-OLDP<span class="org-rainbow-delimiters-depth-2">(</span>I,J<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>**<span class="org-highlight-numbers-number">2</span>
  <span class="org-highlight-numbers-number">120</span> <span class="org-keyword">CONTINUE</span>
      DELTA=<span class="org-builtin">DSQRT</span><span class="org-rainbow-delimiters-depth-1">(</span>DELTA/<span class="org-highlight-numbers-number">4.0D0</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>IOP<span class="org-keyword">.EQ.</span>0<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">140</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">130</span>, DELTA
  <span class="org-highlight-numbers-number">130</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span>/,<span class="org-highlight-numbers-number">4X</span>,<span class="org-highlight-numbers-number">39HDELTA</span><span class="org-rainbow-delimiters-depth-2">(</span>CONVERGENCE OF DENSITY MATRIX<span class="org-rainbow-delimiters-depth-2">)</span> =
     <span class="org-string">$</span>F10.6,/<span class="org-rainbow-delimiters-depth-1">)</span>
  <span class="org-highlight-numbers-number">140</span> <span class="org-keyword">CONTINUE</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CHECK FOR CONVERGENCE</span>
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>DELTA<span class="org-keyword">.LT.</span>CRIT<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">160</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">NOT YET CONVERGED</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">TEST FOR MAXIMUM NUMBER OF ITERATIONS</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">IF MAXIMUM NUMBER NOT YET REACHED</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">GO BACK FOR ANOTHER ITERATION</span>
      <span class="org-keyword">IF</span><span class="org-rainbow-delimiters-depth-1">(</span>ITER<span class="org-keyword">.LT.</span>MAXIT<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">20</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">SOMETHING WRONG HERE</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">150</span>
  <span class="org-highlight-numbers-number">150</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">4X</span>,<span class="org-highlight-numbers-number">21HNO</span> CONVERGENCE IN SCF<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">STOP</span>
  <span class="org-highlight-numbers-number">160</span> <span class="org-keyword">CONTINUE</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CALCULATION CONVERGED IF IT GOT HERE</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">ADD NUCLEAR REPULSION TO GET TOTAL ENERGY</span>
      ENT=EN+ZA*ZB/R
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>IOP<span class="org-keyword">.EQ.</span>0<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">180</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">170</span>, EN, ENT
  <span class="org-highlight-numbers-number">170</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span>//,<span class="org-highlight-numbers-number">4X</span>,<span class="org-highlight-numbers-number">21HCALCULATION</span> CONVERGED,//,
     <span class="org-string">$</span>4X,<span class="org-highlight-numbers-number">20HELECTRONIC</span> ENERGY = ,D20.12,//,
     <span class="org-string">$</span>4X,<span class="org-highlight-numbers-number">20HTOTAL</span> ENERGY =      ,D20.12   <span class="org-rainbow-delimiters-depth-1">)</span>
  <span class="org-highlight-numbers-number">180</span> <span class="org-keyword">CONTINUE</span>
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>IOP<span class="org-keyword">.NE.</span>1<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">190</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">PRINT OUT THE FINAL RESULTS IF</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">HAVE NOT DONE SO ALREADY</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>G,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">4HG</span>   <span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>F,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">4HF</span>   <span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>E,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">4HE</span>   <span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>C,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">4HC</span>   <span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>P,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">4HP</span>   <span class="org-rainbow-delimiters-depth-1">)</span>
  <span class="org-highlight-numbers-number">190</span> <span class="org-keyword">CONTINUE</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">PS MATRIX HAS MULLIKEN POPULATIONS</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MULT</span><span class="org-rainbow-delimiters-depth-1">(</span>P,S,OLDP,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">IF</span><span class="org-rainbow-delimiters-depth-1">(</span>IOP<span class="org-keyword">.EQ.</span>0<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">200</span>
      <span class="org-keyword">CALL</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>OLDP,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">4HPS</span>   <span class="org-rainbow-delimiters-depth-1">)</span>
  <span class="org-highlight-numbers-number">200</span> <span class="org-keyword">CONTINUE</span>
      <span class="org-keyword">RETURN</span>
      <span class="org-keyword">END</span>

<span class="org-comment-delimiter">C*********************************************************************</span>
      <span class="org-keyword">SUBROUTINE</span> <span class="org-function-name">FORMG</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">CALCULATES THE G MATRIX FROM THE DENSITY MATRIX</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">AND TWO-ELECTRON INTEGRALS</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">COMMON</span>/<span class="org-variable-name">MATRIX</span>/S<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,X<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,XT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,H<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,F<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,G<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,
     <span class="org-string">$</span>FPRIME<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,CPRIME<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,P<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,OLDP<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,TT<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,E<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">10</span> I=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">10</span> J=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      G<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>=<span class="org-highlight-numbers-number">0.0D0</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">10</span> K=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">10</span> L=<span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span>
      G<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>=G<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>+P<span class="org-rainbow-delimiters-depth-1">(</span>K,L<span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-rainbow-delimiters-depth-1">(</span>TT<span class="org-rainbow-delimiters-depth-2">(</span>I,J,K,L<span class="org-rainbow-delimiters-depth-2">)</span>-<span class="org-highlight-numbers-number">0.5D0</span>*TT<span class="org-rainbow-delimiters-depth-2">(</span>I,L,K,J<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">10</span> <span class="org-keyword">CONTINUE</span>
      <span class="org-keyword">RETURN</span>
      <span class="org-keyword">END</span>

<span class="org-comment-delimiter">C*********************************************************************</span>
      <span class="org-keyword">SUBROUTINE</span> <span class="org-function-name">DIAG</span><span class="org-rainbow-delimiters-depth-1">(</span>F,C,E<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">DIAGONALIZES F TO GIVE EIGENVECTORS IN C AND EIGENVALUES IN E</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">THETA IS THE ANGLE DESCRIBING SOLUTION</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">DIMENSION</span> <span class="org-variable-name">F</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,<span class="org-variable-name">C</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>,<span class="org-variable-name">E</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">DATA</span> <span class="org-variable-name">PI</span>/<span class="org-highlight-numbers-number">3.1415926535898D0</span>/
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-builtin">DABS</span><span class="org-rainbow-delimiters-depth-2">(</span>F<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-3">)</span>-F<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-keyword">.GT.</span>1.0D-<span class="org-highlight-numbers-number">20</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">10</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">HERE IS SYMMETRY DETERMINED SOLUTION (HOMONUCLEAR DIATOMIC)</span>
      THETA=PI/<span class="org-highlight-numbers-number">4.0D0</span>
      <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">20</span>
   <span class="org-highlight-numbers-number">10</span> <span class="org-keyword">CONTINUE</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">SOLUTION FOR HETERONUCLEAR DIATOMIC</span>
      THETA=<span class="org-highlight-numbers-number">0.5D0</span>*<span class="org-builtin">DATAN</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2.0D0</span>*F<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-2">)</span>/<span class="org-rainbow-delimiters-depth-2">(</span>F<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-3">)</span>-F<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">20</span> <span class="org-keyword">CONTINUE</span>
      C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=<span class="org-builtin">DCOS</span><span class="org-rainbow-delimiters-depth-1">(</span>THETA<span class="org-rainbow-delimiters-depth-1">)</span>
      C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=<span class="org-builtin">DSIN</span><span class="org-rainbow-delimiters-depth-1">(</span>THETA<span class="org-rainbow-delimiters-depth-1">)</span>
      C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=<span class="org-builtin">DSIN</span><span class="org-rainbow-delimiters-depth-1">(</span>THETA<span class="org-rainbow-delimiters-depth-1">)</span>
      C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=-<span class="org-builtin">DCOS</span><span class="org-rainbow-delimiters-depth-1">(</span>THETA<span class="org-rainbow-delimiters-depth-1">)</span>
      E<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=F<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-builtin">DCOS</span><span class="org-rainbow-delimiters-depth-1">(</span>THETA<span class="org-rainbow-delimiters-depth-1">)</span>**<span class="org-highlight-numbers-number">2</span>+F<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-builtin">DSIN</span><span class="org-rainbow-delimiters-depth-1">(</span>THETA<span class="org-rainbow-delimiters-depth-1">)</span>**<span class="org-highlight-numbers-number">2</span>
     <span class="org-string">$</span> +F<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-builtin">DSIN</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2.0D0</span>*THETA<span class="org-rainbow-delimiters-depth-1">)</span>
      E<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=F<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-builtin">DCOS</span><span class="org-rainbow-delimiters-depth-1">(</span>THETA<span class="org-rainbow-delimiters-depth-1">)</span>**<span class="org-highlight-numbers-number">2</span>+F<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-builtin">DSIN</span><span class="org-rainbow-delimiters-depth-1">(</span>THETA<span class="org-rainbow-delimiters-depth-1">)</span>**<span class="org-highlight-numbers-number">2</span>
     <span class="org-string">$</span> -F<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>*<span class="org-builtin">DSIN</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2.0D0</span>*THETA<span class="org-rainbow-delimiters-depth-1">)</span>
      E<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=<span class="org-highlight-numbers-number">0.0D0</span>
      E<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=<span class="org-highlight-numbers-number">0.0D0</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">ORDER EIGENVALUES AND EIGENVECTORS</span>
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>E<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-keyword">.GT.</span>E<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">GO TO</span> <span class="org-highlight-numbers-number">30</span>
      TEMP=E<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
      E<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=E<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>
      E<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=TEMP
      TEMP=C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
      C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>
      C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">1</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=TEMP
      TEMP=C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>
      C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">2</span><span class="org-rainbow-delimiters-depth-1">)</span>=C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>
      C<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-highlight-numbers-number">2</span>,<span class="org-highlight-numbers-number">1</span><span class="org-rainbow-delimiters-depth-1">)</span>=TEMP
   <span class="org-highlight-numbers-number">30</span> <span class="org-keyword">RETURN</span>
      <span class="org-keyword">END</span>

<span class="org-comment-delimiter">C*********************************************************************</span>
      <span class="org-keyword">SUBROUTINE</span> <span class="org-function-name">MULT</span><span class="org-rainbow-delimiters-depth-1">(</span>A,B,C,IM,M<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">MULTIPLIES TWO SQUARE MATRICES A AND B TO GET C</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">DIMENSION</span> <span class="org-variable-name">A</span><span class="org-rainbow-delimiters-depth-1">(</span>IM,IM<span class="org-rainbow-delimiters-depth-1">)</span>,<span class="org-variable-name">B</span><span class="org-rainbow-delimiters-depth-1">(</span>IM,IM<span class="org-rainbow-delimiters-depth-1">)</span>,<span class="org-variable-name">C</span><span class="org-rainbow-delimiters-depth-1">(</span>IM,IM<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">10</span> I=<span class="org-highlight-numbers-number">1</span>,M
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">10</span> J=<span class="org-highlight-numbers-number">1</span>,M
      C<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>=<span class="org-highlight-numbers-number">0.0D0</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">10</span> K=<span class="org-highlight-numbers-number">1</span>,M
   <span class="org-highlight-numbers-number">10</span> C<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>=C<span class="org-rainbow-delimiters-depth-1">(</span>I,J<span class="org-rainbow-delimiters-depth-1">)</span>+A<span class="org-rainbow-delimiters-depth-1">(</span>I,K<span class="org-rainbow-delimiters-depth-1">)</span>*B<span class="org-rainbow-delimiters-depth-1">(</span>K,J<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">RETURN</span>
      <span class="org-keyword">END</span>

<span class="org-comment-delimiter">C*********************************************************************</span>
      <span class="org-keyword">SUBROUTINE</span> <span class="org-function-name">MATOUT</span><span class="org-rainbow-delimiters-depth-1">(</span>A,IM,IN,M,N,LABEL<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C </span><span class="org-comment">PRINT MATRICES OF SIZE M BY N</span>
<span class="org-comment-delimiter">C</span>
<span class="org-comment-delimiter">C*********************************************************************</span>

      <span class="org-type">IMPLICIT DOUBLE PRECISION</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">A</span>-H,<span class="org-variable-name">O</span>-Z<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-type">DIMENSION</span> <span class="org-variable-name">A</span><span class="org-rainbow-delimiters-depth-1">(</span>IM,IN<span class="org-rainbow-delimiters-depth-1">)</span>
      IHIGH=<span class="org-highlight-numbers-number">0</span>
   <span class="org-highlight-numbers-number">10</span> LOW=IHIGH+<span class="org-highlight-numbers-number">1</span>
      IHIGH=IHIGH+<span class="org-highlight-numbers-number">5</span>
      IHIGH=<span class="org-builtin">MIN</span><span class="org-rainbow-delimiters-depth-1">(</span>IHIGH,N<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">20</span>, LABEL,<span class="org-rainbow-delimiters-depth-1">(</span>I,I=LOW,IHIGH<span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">20</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span>///,<span class="org-highlight-numbers-number">3X</span>,<span class="org-highlight-numbers-number">5H</span> THE ,A4,<span class="org-highlight-numbers-number">6H</span> ARRAY,/,<span class="org-highlight-numbers-number">15X</span>,<span class="org-highlight-numbers-number">5</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-highlight-numbers-number">10X</span>,I3,<span class="org-highlight-numbers-number">6X</span><span class="org-rainbow-delimiters-depth-2">)</span>//<span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">DO</span> <span class="org-highlight-numbers-number">30</span> I=<span class="org-highlight-numbers-number">1</span>,M
   <span class="org-highlight-numbers-number">30</span> <span class="org-keyword">PRINT</span> <span class="org-highlight-numbers-number">40</span>, I,<span class="org-rainbow-delimiters-depth-1">(</span>A<span class="org-rainbow-delimiters-depth-2">(</span>I,J<span class="org-rainbow-delimiters-depth-2">)</span>,J=LOW,IHIGH<span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-highlight-numbers-number">40</span> <span class="org-keyword">FORMAT</span><span class="org-rainbow-delimiters-depth-1">(</span>I10,<span class="org-highlight-numbers-number">5X</span>,<span class="org-highlight-numbers-number">5</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-highlight-numbers-number">1X</span>,D18.10<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
      <span class="org-keyword">IF</span> <span class="org-rainbow-delimiters-depth-1">(</span>N-IHIGH<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-highlight-numbers-number">50</span>,<span class="org-highlight-numbers-number">50</span>,<span class="org-highlight-numbers-number">10</span>
   <span class="org-highlight-numbers-number">50</span> <span class="org-keyword">RETURN</span>
      <span class="org-keyword">END</span>
</pre>
</div>

</details>

<p>
The code is getting harder to compile with every update from <code>gfortran</code>, but it is still working under legacy options:
</p>

<div class="org-src-container">
<pre class="src src-bash">gfortran hfso.f -o hfso -std=legacy &amp;&amp; ./hfso 
</pre>
</div>

<pre class="example" id="orga9873e1">
 STO-3G FOR ATOMIC NUMBERS  2.00 AND  1.00


 R          ZETA1      ZETA2      S12        T11

 1.463200   2.092500   1.240000   0.450770   2.164313


 T12        T22        V11A       V12A       V22A

 0.167013   0.760033  -4.139827  -1.102912  -1.265246


 V11B       V12B       V22B       V1111      V2111

-0.677230  -0.411305  -1.226615   1.307152   0.437279


 V2121      V2211      V2221      V2222

 0.177267   0.605703   0.311795   0.774608



  THE S    ARRAY
                         1                  2
       1        0.1000000000D+01   0.4507704116D+00
       2        0.4507704116D+00   0.1000000000D+01



  THE X    ARRAY
                         1                  2
       1        0.5870642812D+00   0.9541310722D+00
       2        0.5870642812D+00  -0.9541310722D+00



  THE H    ARRAY
                         1                  2
       1       -0.2652744703D+01  -0.1347205024D+01
       2       -0.1347205024D+01  -0.1731828436D+01



 ( 1 1 1 1 )  1.307152
 ( 1 1 1 2 )  0.437279
 ( 1 1 2 1 )  0.437279
 ( 1 1 2 2 )  0.605703
 ( 1 2 1 1 )  0.437279
 ( 1 2 1 2 )  0.177267
 ( 1 2 2 1 )  0.177267
 ( 1 2 2 2 )  0.311795
 ( 2 1 1 1 )  0.437279
 ( 2 1 1 2 )  0.177267
 ( 2 1 2 1 )  0.177267
 ( 2 1 2 2 )  0.311795
 ( 2 2 1 1 )  0.605703
 ( 2 2 1 2 )  0.311795
 ( 2 2 2 1 )  0.311795
 ( 2 2 2 2 )  0.774608

  DELTA(CONVERGENCE OF DENSITY MATRIX) =   0.882867


  DELTA(CONVERGENCE OF DENSITY MATRIX) =   0.279176


  DELTA(CONVERGENCE OF DENSITY MATRIX) =   0.029662


  DELTA(CONVERGENCE OF DENSITY MATRIX) =   0.002318


  DELTA(CONVERGENCE OF DENSITY MATRIX) =   0.000174


  DELTA(CONVERGENCE OF DENSITY MATRIX) =   0.000013



  CALCULATION CONVERGED

  ELECTRONIC ENERGY =  -0.422752913203D+01

  TOTAL ENERGY =       -0.286066199152D+01



  THE G    ARRAY
                         1                  2
       1       -0.1473078126D+01  -0.3893277677D+00
       2       -0.1092586075D+01  -0.2290700802D+00



  THE F    ARRAY
                         1                  2
       1       -0.1458636156D+01  -0.1050591833D+01
       2       -0.1050591833D+01  -0.8105094301D+00



  THE E    ARRAY
                         1                  2
       1       -0.1597448132D+01   0.0000000000D+00
       2        0.0000000000D+00  -0.6166851652D-01



  THE C    ARRAY
                         1                  2
       1        0.8019175078D+00  -0.7822652261D+00
       2        0.3368004878D+00   0.1068445602D+01



  THE P    ARRAY
                         1                  2
       1        0.1286143379D+01   0.5401724156D+00
       2        0.5401724156D+00   0.2268691372D+00



  THE PS   ARRAY
                         1                  2
       1        0.1529637121D+01   0.1119927796D+01
       2        0.6424383099D+00   0.4703628793D+00
</pre>
</div>
</body>
</html>
