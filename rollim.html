<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>A coding impromptu</title>
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="assets/style.css"/>
<link rel="icon" href="assets/favicon.ico" type="image/x-icon">
<style>
#table-of-contents > h2 { display: none; } /* Hide the default TOC heading */
#table-of-contents > ul { display: block; } /* Ensure TOC content is shown */
</style>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">A coding impromptu</h1>
<p>
This post is a rolling collection of algorithms and computational ideas I like, implemented in BQN:
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org90491b8">Z algorithm</a></li>
<li><a href="#orga2b71b5">Longest increasing sub-sequence</a></li>
<li><a href="#orgda4b81e">N-queens problem</a></li>
<li><a href="#org0b78cad">Majority element</a></li>
<li><a href="#org5224e3e">An identity on the naturals</a></li>
<li><a href="#org71c565c">Depth of nested lists</a></li>
<li><a href="#org7084983">H-index</a></li>
</ul>
</div>
</div>

<p>
Extrapolating Perlis' remark<sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>, it's likely that a group of 50 individuals
would devise 35 to 40 distinct solutions to even the simplest problem in BQN. Therefore, I will frequently
juxtapose my implementations with those of seasoned <i>BQNators</i><sup><a id="fnr.2" class="footref" href="#fn.2" role="doc-backlink">2</a></sup>.
</p>
<div id="outline-container-org90491b8" class="outline-2">
<h2 id="org90491b8">Z algorithm</h2>
<div class="outline-text-2" id="text-org90491b8">
<p>
This is a very efficient procedure that finds prefix strings in <a href="https://cp-algorithms.com/string/z-function.html">linear time</a>. The imperative
implementation reads:
</p>

<div class="org-src-container">
<pre class="src src-bqn">ZI â† {ğ•Šs:
  lâ€¿râ€¿z â† 0âš‡0 0â€¿0â€¿s
  z âŠ£ {
    v â† r(âŠ¢1âŠ¸+â€¢_while_{(ğ•©+ğ•¨)&lt;â‰ s ? =Â´âŸ¨ğ•©,ğ•©+ğ•¨âŸ©âŠ‘Â¨&lt;s ; 0}&lt;â—¶({zâŠ‘Ëœğ•©-l}âŒŠ-+1)â€¿0)ğ•©
    r &lt;â—¶@â€¿{ğ•Š: lâ†©ğ•©-v+1 â‹„ râ†©ğ•©} ğ•©+v-1
    z vâŒ¾(ğ•©âŠ¸âŠ‘)â†©
  }Â¨ â†•â‰ s
}
ZI "abacabadabacaba"
</pre>
</div>

<pre class="example">
âŸ¨ 15 0 1 0 3 0 1 0 7 0 1 0 3 0 1 âŸ©
</pre>


<p>
Two algorithmic improvements can be made here, namely only iterate
over indices where the character found is equal to the first character, and only search
to extend the count if it goes up to the end of r:
</p>

<div class="org-src-container">
<pre class="src src-bqn">ZFun â† {ğ•Šs:
  CountEq â† { 1âŠ¸+â€¢_while_((â‰ ğ•¨)âŠ¸â‰¤â—¶âŸ¨âŠ‘âŸœğ•¨â‰¡âŠ‘âŸœğ•©,0âŸ©) 0 }
  lâ†râ†0 â‹„ Ulr â† {(râŒˆâ†©ğ•¨+ğ•©)&gt;r ? lâ†©ğ•¨ â‹„ ğ•©; ğ•©}
  SearchEq â† âŠ£ Ulr âŠ¢ + + CountEqâ—‹(â†“âŸœs) âŠ¢
  Set â† {iğ•Šğ•©: ((r-i) (i SearchEq 0âŒˆâŠ£)âŸâ‰¤ (i-l)âŠ‘ğ•©)âŒ¾(iâŠ¸âŠ‘) ğ•© }
  (âŒ½1â†“/âŠ‘âŠ¸=s) SetÂ´Ëœ â†‘Ëœâ‰ s
}
</pre>
</div>

<p>
I came up with two array versions, with quadratic and cubic time complexities respectively:
</p>

<div class="org-src-container">
<pre class="src src-bqn">ZAQ â† Â¯1â†“â†“(+Â´Â·âˆ§`âŠ£=â‰ âŠ¸â†‘)Â¨&lt;
ZAC â† (+Â´âˆ§`)Â¨&lt;=â†•âˆ˜â‰ {Â«âŸğ•¨ğ•©}âŒœ&lt;
(ZAQâ‰¡ZAC)â—¶@â€¿ZAC "abacabadabacaba"
</pre>
</div>

<pre class="example">
âŸ¨ 15 0 1 0 3 0 1 0 7 0 1 0 3 0 1 âŸ©
</pre>


<p>
With further refinements, the earlier solutions can be transformed into:
</p>

<div class="org-src-container">
<pre class="src src-bqn">ZAQâ€¿ZAC â† {(+Â´âˆ§`)Â¨ğ•}Â¨ âŸ¨â‰ â†‘â†“=âŒ½âˆ˜â†‘, &lt;=Â«âŸ(â†•âˆ˜â‰ )âŸ©
</pre>
</div>
</div>
</div>
<div id="outline-container-orga2b71b5" class="outline-2">
<h2 id="orga2b71b5">Longest increasing sub-sequence</h2>
<div class="outline-text-2" id="text-orga2b71b5">
<p>
This <a href="https://en.wikipedia.org/wiki/Longest_increasing_subsequence">problem</a> can be solved in \(O(n\log n)\) using dynamic programming. Here is an
imperative implementation which is quadratic, but can be optimized:
</p>

<div class="org-src-container">
<pre class="src src-bqn">LISI â† {
  kâ€¿dp â† Â¯1â€¿(âˆÂ¨ğ•©)
  {i â† âˆ§Â´â—¶(âŠ‘âŠâŸœ0)â€¿{ğ•Š:k+â†©1} dp&lt;ğ•© â‹„ dp ğ•©âŒ¾(iâŠ¸âŠ‘)â†©}Â¨ ğ•©
  +Â´âˆ&gt;dp
}
LISIÂ¨ âŸ¨0â€¿1â€¿0â€¿3â€¿2â€¿3, 10â€¿9â€¿2â€¿5â€¿3â€¿7â€¿101â€¿18, 7â€¿7â€¿7â€¿7â€¿7âŸ©
</pre>
</div>

<pre class="example">
âŸ¨ 4 4 1 âŸ©
</pre>


<p>
A more elegant array solution is:
</p>

<div class="org-src-container">
<pre class="src src-bqn">LISA â† +Â´âˆâ‰ âˆÂ¨{ğ•¨âŒ¾((âŠ‘ğ•©â‹ğ•¨-1)âŠ¸âŠ‘)ğ•©}Â´âŒ½
LISAÂ¨ âŸ¨0â€¿1â€¿0â€¿3â€¿2â€¿3, 10â€¿9â€¿2â€¿5â€¿3â€¿7â€¿101â€¿18, 7â€¿7â€¿7â€¿7â€¿7âŸ©
</pre>
</div>

<pre class="example">
âŸ¨ 4 4 1 âŸ©
</pre>


<p>
Let's <code>)explain</code> this optimized version, so we can truly appreciate its beauty:
</p>

<pre class="example" id="orga267350">
 +Â´âˆâ‰ âˆÂ¨{ğ•¨âŒ¾((âŠ‘ğ•©â‹ğ•¨-1)âŠ¸âŠ‘)ğ•©}Â´âŒ½ 
 â”‚ â”‚ â”‚ â”‚â”‚    â”‚ â”‚ â”‚  â”‚ â”‚  â”‚ 
 â”‚ â”‚ â”‚ {â”¼â”€â”€â”€â”€â”¼â”€â”¼â”€â”¼â”€â”€â”¼â”€â”¼â”€Â´â”‚ 
 â”‚ â”‚ âˆÂ¨ â”‚    â”‚ â”‚ â”‚  â”‚ â”‚ â”‚â”‚ 
 â”‚ â”‚  â””â”€â”¼â”€â”€â”€â”€â”¼â”€â”¼â”€â”¼â”€â”€â”¼â”€â”¼â”€â”¼âŒ½ 
 â”‚ âˆâ‰ â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”¼â”€â”¼â”€â”€â”¼â”€â”¼â”€â”˜  
 +Â´ â”‚   â”‚    â”‚ â”‚ â”‚  â”‚ â”‚    
  â””â”€â”˜   â”‚    â”‚ â”‚ â”‚  â”‚ â”‚    
        â”‚    â”‚ ğ•¨-1  â”‚ â”‚    
        â”‚    ğ•©â‹â”€â”˜   â”‚ â”‚    
        â”‚   âŠ‘â”€â”˜     â”‚ â”‚    
        â”‚   â””â”€â”€â”€â”€â”€â”€âŠ¸âŠ‘ â”‚    
        ğ•¨âŒ¾â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ğ•©    
â•¶â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>

<p>
The full expression is structured as a two-train: we sum all finite entries from the
result of the rightmost three-train. The three-train is a right fold over the reversed
input, with an initial array of <code>âˆ</code> and the same length as the input. In each step
of the fold, we modify the right argument using under: we perform a binary search
with strict comparison to find where the next element should go.
The element is either placed at the end of the unfilled region, or it replaces
the first element that is greater than <code>ğ•¨</code>. Since BQN uses a based array model,
we pick the enclosed atom from this operation's result. So it goes<sup><a id="fnr.3" class="footref" href="#fn.3" role="doc-backlink">3</a></sup>.
</p>
</div>
</div>
<div id="outline-container-orgda4b81e" class="outline-2">
<h2 id="orgda4b81e">N-queens problem</h2>
<div class="outline-text-2" id="text-orgda4b81e">
<p>
This problem is the archetypal example of backtracking. Initially, I tried to solve it
using a function to place the queens in the full board, hoping that it would lead to a
more array oriented solution:
</p>

<div class="org-src-container">
<pre class="src src-bqn">8 {((âˆ¨âŒœÂ´0âŠ¸=)âˆ¨(0=-âŒœÂ´)âˆ¨0=+âŒœÂ´) ğ•©-Â¨&lt;â†•ğ•¨} 2â€¿3
</pre>
</div>

<pre class="example" id="org5b7fbd4">
â”Œâ”€                 
â•µ 0 1 0 1 0 1 0 0  
  0 0 1 1 1 0 0 0  
  1 1 1 1 1 1 1 1  
  0 0 1 1 1 0 0 0  
  0 1 0 1 0 1 0 0  
  1 0 0 1 0 0 1 0  
  0 0 0 1 0 0 0 1  
  0 0 0 1 0 0 0 0  
                  â”˜
</pre>

<p>
This resulted in a more complicated algorithm, so I decided to go for the classical
Wirth implementation:
</p>

<div class="org-src-container">
<pre class="src src-bqn">NQ â† {ğ•Šn:
  Vâ€¿P â† {âŠ£ğ•(âŠ¢âˆ¾-â‹ˆ+)Â´âˆ˜âŠ¢}Â¨ âŸ¨âˆ¨Â´âŠ‘Â¨Ëœ, {1âŒ¾(ğ•©âŠ¸âŠ‘)ğ•¨}Â¨âŸ©
  {nâ‰ ğ•© ? +Â´(ğ•¨VâŠ¢)â—¶âŸ¨(ğ•©+1)ğ•ŠËœğ•¨PâŠ¢,0âŸ©âˆ˜(ğ•©â‹ˆâŠ¢)Â¨ â†•n ; 1
  }ËœÂ´ (0â‹ˆ0Ã—Â·â†•Â¨âŠ¢âˆ¾Â·â‹ˆËœ+Ëœ)n 
}
</pre>
</div>

<p>
Which nicely compares with the OEIS <a href="https://oeis.org/A000170">sequence</a>:
</p>

<div class="org-src-container">
<pre class="src src-bqn">a000170 â† 1â€¿0â€¿0â€¿2â€¿10â€¿4â€¿40â€¿92
a000170 â‰¡ NQÂ¨ 1+â†•8
</pre>
</div>

<pre class="example">
1
</pre>


<p>
And of course, in the implementation above I could have used a single array instead of three,
but I find the resulting validation and position functions very aesthetic the way they are.
</p>
</div>
</div>
<div id="outline-container-org0b78cad" class="outline-2">
<h2 id="org0b78cad">Majority element</h2>
<div class="outline-text-2" id="text-org0b78cad">
<p>
The <a href="https://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_majority_vote_algorithm">Boyerâ€“Moore</a> algorithm allows for finding the majority element (element that appears
more than <code>âŒŠğ•©Ã·2</code> times in the array) in linear time. If such element exists, then it is
equal to the mode of the data, and for this task we have a nice array <a href="https://mlochbaum.github.io/bqncrate/?q=mode#">solution</a>. The original
implementation could be expressed as:
</p>

<div class="org-src-container">
<pre class="src src-bqn">BM â† {vâ†0 â‹„ Iâ†âŠ¢âŠ£=â—¶{ğ•Š:v+â†©1}â€¿{ğ•Š:v-â†©1} â‹„ 0{ğ•Š:v=0}â—¶âŸ¨I,IËœâŠ£âŸ©Â´ğ•©}
BM 6â€¿1â€¿3â€¿1â€¿3â€¿3â€¿4â€¿3â€¿3â€¿5
</pre>
</div>

<pre class="example">
3
</pre>


<p>
The previous fold tracks the majority element as state, a more elegant approach maintains
the number of votes:
</p>

<div class="org-src-container">
<pre class="src src-bqn">BM â† {eâ†@ â‹„ 0{ğ•©=0 ? eâ†©ğ•¨â‹„1 ; ğ•©+Â¯1â‹†eâ‰¢ğ•¨}Â´ğ•© â‹„ e}
BM 6â€¿1â€¿3â€¿1â€¿3â€¿3â€¿4â€¿3â€¿3â€¿5
</pre>
</div>

<pre class="example">
3
</pre>
</div>
</div>
<div id="outline-container-org5224e3e" class="outline-2">
<h2 id="org5224e3e">An identity on the naturals</h2>
<div class="outline-text-2" id="text-org5224e3e">
<p>
Some time ago, while working on performance optimization of linear algebra
operations with Boolean arrays, I encountered an
interesting summation property for an array \(a\) of length \(n\):
</p>

\begin{equation*}
    \sum_{i | a_i \neq 0} \sum_{j=i+1} f_j
  = \sum_{j=0} f_j \sum_{i < j | a_i \neq 0} 1
\end{equation*}

<p>
It turns out that the RHS can be elegantly transformed
into a scan, giving rise to a beautiful identity that applies to all
natural numbers, not just Booleans as I initially thought:
</p>

<div class="org-src-container">
<pre class="src src-bqn">(+`â‰¡Â·+Â´/â‰¤âŸœ&lt;âŠ’Ëœ) â€¢rand.RangeËœ 1e3
</pre>
</div>

<pre class="example">
1
</pre>


<p>
This identity holds because <code>âŠ’Ëœ</code> represents the indices <code>i</code> of the list,
and since <code>+Â´(/ğ•©)=i â†â†’ iâŠ‘ğ•©</code>, the fold sums all the elements in <code>ğ•©</code> up to <code>i</code>, for
<code>i</code> in the range of the length of the list. Ergo, a scan.
</p>
</div>
</div>
<div id="outline-container-org71c565c" class="outline-2">
<h2 id="org71c565c">Depth of nested lists</h2>
<div class="outline-text-2" id="text-org71c565c">
<p>
Studying tree algorithms in APL, I learned about the depth vector <a href="https://asherbhs.github.io/apl-site/trees/representing-trees.html">representation</a>. If
the nested object in consideration is a string, the best approach is using boolean <a href="https://mlochbaum.github.io/bqncrate/?q=depth%20of%20parens#">masks</a>.
However, when dealing with a BQN list, recursion becomes necessary to determine
the depth of nested elements. Hereâ€™s how it can be implemented:
</p>

<div class="org-src-container">
<pre class="src src-bqn">{=â—¶âŸ¨â‹ˆ0, 1+Â·âˆ¾ğ•ŠÂ¨âŸ©ğ•©} âŸ¨1, âŸ¨2, âŸ¨3âŸ©, âŸ¨4, âŸ¨5, âŸ¨6, 7âŸ©âŸ©âŸ©âŸ©, 1âŸ©
</pre>
</div>

<pre class="example">
âŸ¨ 1 2 3 3 4 5 5 1 âŸ©
</pre>
</div>
</div>
<div id="outline-container-org7084983" class="outline-2">
<h2 id="org7084983">H-index</h2>
<div class="outline-text-2" id="text-org7084983">
<p>
This metric is one of the reasons for the <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2407748">deplorable</a> state of modern academia,
and the headaches for <i>outsiders</i> trying to get in. Consider that Peter Higgs
has an estimated h-index of only <a href="https://www.semanticscholar.org/author/P.-W.-Higgs/50750305">12</a>. By contrast, a random professor nowadays 
boasts an h-index ten times as high, and exponentially less impact.
Enough of ranting, let's concentrate on finding an elegant way to
implement this useless thing:
</p>

<div class="org-src-container">
<pre class="src src-bqn">HL â† (+Â´âˆ˜Â«âŠ’Ëœâ‰¤+`âŒ¾âŒ½)Â·/â¼â‰ âŠ¸âŒŠ
HS â† +Â´âˆ¨â‰¥1+âŠ’Ëœ
(HLâ‰¡HS)â—¶@â€¿HL 14â€¿14â€¿11â€¿9â€¿5â€¿5â€¿1â€¿1â€¿1â€¿1â€¿0
</pre>
</div>

<pre class="example">
5
</pre>


<p>
If someone ever published that much, sorting will eventually be slower:
</p>

<div class="org-src-container">
<pre class="src src-bqn">HLâ€¿HS {ğ•â€¢_timedğ•©}Â¨&lt; 1e8 â€¢rand.Range 1e3
</pre>
</div>

<pre class="example">
âŸ¨ 0.083824959 0.21801262700000001 âŸ©
</pre>


<p>
A testament to the idea that the simplest solution in BQN is often the most efficient:
I initially clip my citations array with <code>{â‰ Â¨âŠ”â‰ âˆ˜ğ•©Â¨âŒ¾(â‰¥âŸœâ‰ âˆ˜ğ•©âŠ¸/)ğ•©}</code>, which is just <code>/â¼â‰ âŠ¸âŒŠ</code>.
</p>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
Almost Perfect Artifacts Improve only in Small Ways: APL is more French than English,
Alan J. Perlis (1978). From <a href="https://www.jsoftware.com/papers/perlis78.htm">jsoftware</a>'s papers collection.
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2" role="doc-backlink">2</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
Initially, I intended to rigorously attribute all contributions, but this
quickly filled the text with footnotes. I often get help streamlining my solutions
from <a href="https://github.com/mlochbaum">Marshall Lochbaum</a> (the BQN creator), <a href="https://github.com/dzaima">dzaima</a> (the CBQN developer),
and other fine folks from the BQN matrix <a href="https://app.element.io/#/room/%23array:matrix.org">room</a>, thank you all! Please check the <a href="https://github.com/dzaima/chatlogs">logs</a> for more context.
</p></div></div>

<div class="footdef"><sup><a id="fn.3" class="footnum" href="#fnr.3" role="doc-backlink">3</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
Donâ€™t believe me? Just ask Kilgore Trout!
</p>

<div style="text-align: center; font-size: 2em; padding: 20px 0;">
  <a href="https://panadestein.github.io/blog/" style="text-decoration: none;">âŠ‘âˆ˜âˆ</a>
</div></div></div>


</div>
</div></div>
</body>
</html>
