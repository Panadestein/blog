# -*- eval: (face-remap-add-relative 'default '(:family "BQN386 Unicode" :height 180)); -*-
#+TITLE: Helonium's Hartree-Fock program
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="assets/style.css"/>
#+HTML_HEAD: <link rel="icon" href="assets/favicon.ico" type="image/x-icon">
#+HTML_HEAD: <style>
#+HTML_HEAD: mjx-container[jax="CHTML"] {
#+HTML_HEAD:   overflow-x: auto !important;
#+HTML_HEAD: }
#+HTML_HEAD: </style>

** Exordium

We will implement the Hartree-Fock[fn:1] program from the classic [[https://store.doverpublications.com/products/9780486691862][Szabo-Ostlund]] text,
a staple in quantum chemistry. If you have any experience in the field, chances are you know it well.
If you don't, the BQN implementation will take you only a few cognitive units: the coarse mathematical
description involves basis sets, the calculation of electronic integrals, and the self-consistent
optimization of the Fock matrix. Using this program, we will compute the energy of the HeH\(^+\) molecule[fn:2].

First, we import the required BQN system values and utility functions:

#+begin_src bqn :results none :tangle ./bqn/hf.bqn
  Sinâ€¿Cosâ€¿ATanâ€¿Erf â† â€¢math
  Setplotâ€¿Plot â† â€¢Import "../bqn-utils/plots.bqn"
#+end_src

Some auxiliary functions are needed for the computation of the Boys function, the matrix and vector product,
the spectrum of a matrix with shape 2â€¿2, and LÃ¶wdin's canonical orthogonalization. Additionally, we define
a 1-modifier to compute the fixed point of a function:

#+begin_src bqn :results none :tangle ./bqn/hf.bqn
  E â† 1eÂ¯6âŠ¸<â—¶(1-Ã·âŸœ3)â€¿((Ï€Ã·4)âŠ¸Ã·Ã—âŸœErfâ—‹âˆšâŠ¢)
  P â† +Ëâˆ˜Ã—â‰1â€¿âˆ
  D â† (âŠ¢â‹ˆÂ·PÂ´<âˆ˜âŠ¢âˆ¾â‹ˆ)âŸœ([Cosâ€¿Sinâ‹„Sinâ€¿(-Cos)]{ğ•ğ•©}Â¨Â·<2Ã·ËœÂ·ATan 2Ã—0â€¿1âŠ¸âŠ‘Ã·Â·-Â´0â€¿0âŠ¸â‰)
  L â† (-âŒ¾(1â€¿1âŠ¸âŠ‘)Â·Ã·âˆ˜âˆšâ‰¢â¥Š2Ë™)âŠ¸P(0Â¨âŒ¾(0â€¿0â‰âŒ½Ë˜)Â·Ã·âˆ˜âˆš1+1â€¿Â¯1Ã—âŒ½Ë˜)
  _fp â† {ğ•Šâˆ˜âŠ¢âŸâ‰¢âŸœğ”½ğ•©}
#+end_src

Then, we define a function returning a namespace with the physical constants of the system[fn:3],
as is customary in /ab-initio/ methods. We have the flexibility of providing different molecular
geometries:

#+begin_src bqn :results none :tangle ./bqn/hf.bqn
  System â† {ğ•Šğ•©:
    e1â€¿e2 â‡ 2.0925â€¿1.24
    z1â€¿z2 â‡ 2â€¿1
    r â‡ ğ•©
  }
#+end_src

** Basis set

Basis sets are used to transform the PDEs into linear algebra problems. Physical intuition suggests that
Slater type orbitals[fn:4] are a good choice for our Hamiltonian. However, the computation of the integrals
is a lot easier if we approximate them using Gaussian functions[fn:5]. Specifically, the STO-3G approach defines
the approximating function as follows:

#+begin_src bqn :results none :tangle ./bqn/hf.bqn
  STO â† {
    e â† 0.109818â€¿0.405771â€¿2.22766 Ã—Ã—Ëœ ğ•©
    c â† 0.444635â€¿0.535328â€¿0.154329
    eâ‹ˆcÃ—(2Ã—eÃ·Ï€)â‹†3Ã·4
  }
#+end_src

** Electronic integrals

Constructing the integrals' tensor is complicated[fn:6] and is the main reason for the poor scaling
of electronic structure methods. The \(1s\) orbitals are the simplest case, and here two types of integrals
are analytical (S, T) while the rest already lacks a closed-form solution (V, ERI):

#+begin_src bqn :results none :tangle ./bqn/hf.bqn 
  S â† {aâ€¿bğ•Šğ•©: (1.5â‹†ËœÏ€Ã·a+b) Ã— â‹†-ğ•©Ã—a(Ã—Ã·+)b}
  T â† {aâ€¿bğ•Šğ•©: f â† a(Ã—Ã·+)b â‹„ Ã—Â´âŸ¨1.5â‹†ËœÏ€Ã·a+b, (3Ã—f)-2Ã—ğ•©Ã—Ã—Ëœf, â‹†-ğ•©Ã—fâŸ©}
  V â† {aâ€¿bâ€¿zğ•Šrâ€¿s: Ã—Â´âŸ¨-2Ã—zÃ—Ï€Ã·a+b, E sÃ—a+b, â‹†-rÃ—a(Ã—Ã·+)bâŸ©}
  ERI â† {aâ€¿bâ€¿câ€¿dğ•Šr1â€¿r2â€¿r3â€¿r4:
    r5 â† -Â´âŸ¨aâ€¿b â‹„ câ€¿dâŸ© (+Â´âˆ˜Ã—Ã·+Â´âˆ˜âŠ£)Â¨ âŸ¨r1â€¿r2 â‹„ r3â€¿r4âŸ©
    f1â€¿f2â€¿f3 â† aâ€¿b ({(âˆšâˆ˜+Ã—Ã—)â‹ˆ(Ã—Ã·+)}â—‹(+Â´)âˆ¾<âˆ˜â‹ˆâ—‹((Ã—Ã·+)Â´)) câ€¿d
    Ã—Â´âŸ¨f1Ã·Ëœ2Ã—Ï€â‹†5Ã·2, E f2Ã—Ã—Ëœr5, â‹†-+Â´f3Ã—Ã—Ëœ-Â´Â¨âŸ¨r1â€¿r2, r3â€¿r4âŸ©âŸ©
  }
#+end_src

#+begin_export html
<br/>
<details>
<summary>Derivation strategy</summary>
#+end_export

We need to compute the overlap (S), kinetic energy (T), nuclear attraction (V), and four-center (ERI) integrals.
Crucially, the product of two Gaussians at different centers is proportional to a Gaussian at a scaled center.
This property, combined with the Laplacian of a Gaussian, readily yields S and T. The remaining
two sets are more complex: we combine the Gaussians as before, then transform to reciprocal space where
the delta distribution arises and simplifies the problem to this integration by reduction:

\begin{equation*}
  I(x) = \int_0^{\infty}{{{e^ {- a\,k^2 }\,\sin \left(k\,x\right)}\over{k}}\;dk} \sim \text{Erf}(x)
\end{equation*}

#+begin_export html
</details>
#+end_export

The following namespace exports the corresponding integral arrays. Extending the code to an arbitrary number
of atoms implies mapping over an array of coordinates, as opposed to fusing them in the implementation.

#+begin_src bqn :tangle ./bqn/hf.bqn :results none
  I â† {ğ•Še1â€¿e2â€¿z1â€¿z2â€¿r:
    bsâ€¿naâ€¿nb â† (<âˆ¾Â·â‰¢âŠâˆ˜>)â‰>STOÂ¨ e1â€¿e2
    M â† {âˆ¾â€¿Ã—({2: {nb(â‹ˆËœ/âˆ˜â‹ˆËœ)âŠ¸âŠ”ğ•âŒœËœğ•©}; 4: {ğ•âŒœâŸ3Ëœğ•©}}ğ•©)Â¨â—‹âŠ¢<âˆ˜âˆ¾Ë˜bs}

    smâ€¿hcore â‡ {eğ•Šc:
      mst â† âŒ½âŠ¸â‰âˆ¾âŸœ0Ã—Ëœr
      r1â€¿r2 â† <Ë˜â‰â¼> (râŠ¸-âŠ¸â‹ˆËœÃ—âŸœrÃ·+)âŒœÂ´ âŠbs
      mv â† Ã—Ëœâˆ˜{[0â€¿2,3â€¿1]âŠ({0â€¿ğ•¨Â¨ğ•©}âŸœğ•©Â¨ğ•¨)âˆ¾â‹ˆâŸœâ‰râ‹ˆÂ¨ğ•©}Â´Â¨âŸ¨0â€¿r, r1âŸ©â€¿âŸ¨râ€¿0, r2âŸ©
      (âŠ‘â‹ˆÂ·+Â´1âŠ¸â†“)+Â´âˆ˜â¥ŠÂ¨Â¨ c<âŠ¸Ã— ({eğ•Â¨Â¨mst}Â¨Sâ€¿T) âˆ¾ z1â€¿z2{eâˆ¾âŸœğ•¨âŠ¸VÂ¨Â¨ğ•©}Â¨mv
    }Â´ M 2

    erim â‡ {eğ•Šc:
      meri â† (câŠ¸Ã—âŠ£ERIÂ¨âŠ¢/ËœÂ·<Â¨â‰¢âˆ˜âŠ£Ã·â‰¢âˆ˜âŠ¢)âŸœ{0â€¿râŠËœâš‡1â†•naÂ¨â†•=ğ•©} e
      =âŠ¸{+Ëâˆ˜â¥Šâ‰ğ•¨ (2Ã—â†•ğ•¨)â‰â¼(naâ€¿nbâ¥ŠËœnaÃ—ğ•¨)â¥Šğ•©} meri
    }Â´ M 4
  }
#+end_src

#+begin_export html
<br/>
<details>
<summary>Performance</summary>
#+end_export

The computation of the ERIs is expected to be the primary bottleneck, as there are =Nâ‹†4= of themâ€”in our case, 16.
The required tensors have a shape of =6Â¨â†•4=. As shown in the profile below, using an array-based strategy
for the ERIs significantly improved their computational efficiency compared to the two-center integrals.
For the latter, I increased the depth by grouping the tables (block matrices). The resulting code was significantly
slower than replicating the elements to match each axis' length, like I do for the ERIs.

#+begin_src bqn :exports both :tangle no :results raw :wrap example
  )profile {ğ•Š: Iâˆ˜System 1.4632}Â¨â†•1e4
#+end_src

#+RESULTS:
#+begin_example
Got 38006 samples
(self-hosted runtime1): 1067 samples
(REPL): 36939 samples:
    72â”‚I â† {ğ•Še1â€¿e2â€¿z1â€¿z2â€¿r:
    68â”‚  bsâ€¿naâ€¿nb â† (<âˆ¾Â·â‰¢âŠâˆ˜>)â‰>STOÂ¨ e1â€¿e2
  2053â”‚  M â† {âˆ¾â€¿Ã—({2: {nb(â‹ˆËœ/âˆ˜â‹ˆËœ)âŠ¸âŠ”ğ•âŒœËœğ•©}; 4: {ğ•âŒœâŸ3Ëœğ•©}}ğ•©)Â¨â—‹âŠ¢<âˆ˜âˆ¾Ë˜bs}
      â”‚
   245â”‚  smâ€¿hcore â‡ {eğ•Šc:
    75â”‚    mst â† âŒ½âŠ¸â‰âˆ¾âŸœ0Ã—Ëœr
  4181â”‚    r1â€¿r2 â† <Ë˜â‰â¼> (râŠ¸-âŠ¸â‹ˆËœÃ—âŸœrÃ·+)âŒœÂ´ âŠbs
 16277â”‚    mv â† Ã—Ëœâˆ˜{[0â€¿2,3â€¿1]âŠ({0â€¿ğ•¨Â¨ğ•©}âŸœğ•©Â¨ğ•¨)âˆ¾â‹ˆâŸœâ‰râ‹ˆÂ¨ğ•©}Â´Â¨âŸ¨0â€¿r, r1âŸ©â€¿âŸ¨râ€¿0, r2âŸ©
  8830â”‚    (âŠ‘â‹ˆÂ·+Â´1âŠ¸â†“)+Â´âˆ˜â¥ŠÂ¨Â¨ c<âŠ¸Ã— ({eğ•Â¨Â¨mst}Â¨Sâ€¿T) âˆ¾ z1â€¿z2{eâˆ¾âŸœğ•¨âŠ¸VÂ¨Â¨ğ•©}Â¨mv
  3708â”‚  }Â´ M 2
      â”‚
     8â”‚  erim â‡ {eğ•Šc:
  1100â”‚    meri â† (câŠ¸Ã—âŠ£ERIÂ¨âŠ¢/ËœÂ·<Â¨â‰¢âˆ˜âŠ£Ã·â‰¢âˆ˜âŠ¢)âŸœ{0â€¿râŠËœâš‡1â†•naÂ¨â†•=ğ•©} e
   318â”‚    =âŠ¸{+Ëâˆ˜â¥Šâ‰ğ•¨ (2Ã—â†•ğ•¨)â‰â¼(naâ€¿nbâ¥ŠËœnaÃ—ğ•¨)â¥Šğ•©} meri
     4â”‚  }Â´ M 4
      â”‚}
#+end_example

Morals: Never underestimate the power of vectorization and reshaping operations are often computationally trivial.

#+begin_export html
</details>
#+end_export

** Fock matrix

The following function constructs the Fock matrix, our approximation to the true Hamiltonian of the system:

#+begin_src bqn :results none :tangle ./bqn/hf.bqn
  F â† {ğ•©.hcore + ğ•¨ (+Ëâˆ˜â¥Šâ‰2âŠ£Ã—â‰2âŠ¢-2Ã·Ëœ0â€¿3â€¿2âŠ¸â‰â¼) ğ•©.erim}
#+end_src

#+begin_export html
<br/>
<details>
<summary>Physical context</summary>
#+end_export

The Fock operator is an effective one-electron operator that arises after constrained
minimization of the energy functional. The form of the functional is a consequence of
the use of [[https://en.wikipedia.org/wiki/Slater_determinant][Slater determinants]] as wave functions.

\begin{equation*}
  \tilde{\mathcal{F}} \left[ \{\psi_i\} \right] = \sum_i h_i +
  \frac{1}{2} \sum_{i,j} (J_{ij} - K_{ij}) - \sum_{i,j} \lambda_{ij}
  \left( \langle \psi_i | \psi_j \rangle - \delta_{ij} \right)
\end{equation*}

where \(h_i\) is the core Hamiltonian matrix, \(J_{ij}, K_{ij}\) are the Coulomb and
exchange components of the ERI matrix, and \(\lambda_{ij}\) are Lagrange multipliers.
To fully understand the derivation, consider the variational derivative of this
functional with respect to the complex conjugate of the one-particle wave function \(\psi_i^*\):

\begin{align*}
  \lim_{\epsilon \to 0} \frac{\tilde{\mathcal{F}} \left[ \psi_k^* + \epsilon \delta
   \psi_k^* \right] - \tilde{\mathcal{F}} \left[ \psi_k^* \right]}{\epsilon} 
  &= \langle \delta \psi_k | \hat{h} | \psi_k \rangle + \sum_j \left( \langle \delta
   \psi_k \psi_j | \frac{1}{r} | \psi_k \psi_j \rangle - \langle \delta
   \psi_k \psi_j | \frac{1}{r} | \psi_j \psi_k \rangle \right)
   - \sum_j \lambda_{kj} \langle \delta \psi_k | \psi_j \rangle \\
  &= \int \left[ \hat{h} \psi_k(x) + \sum_j
     \left( \psi_k(x) \int \frac{|\psi_j(x')|^2}{|r - r'|} dx'
   - \psi_j(x) \int \frac{\psi_j^*(x') \psi_k(x')}{|r - r'|} dx' \right) \right.
   \left. - \sum_j \lambda_{kj} \psi_j(x) \right] \delta \psi_k^*(x) \, dx.
\end{align*}

As discussed earlier, basis sets are used to discretize the Hartree-Fock problem.
This process results in the  [[https://en.wikipedia.org/wiki/Roothaan_equations][Roothaan equations]], which are implemented in the code below.

#+begin_export html
</details>
#+end_export

** Self-consistent field

The final stage of the computation involves solving the pseudo-eigenvalue problem using a fixed-point iteration.
This process is commonly known as the self-consistent field method, a term coined by D. R. Hartree.

#+begin_src bqn :tangle ./bqn/hf.bqn :results none
  SCF â† {
    ints â† Iğ•©
    pm â† {2Ã—Ã—âŒœËœâŠâ‰ xm(âŠ¢PâŸœâŠ‘Â·DÂ·PÂ´â‰âˆ˜âŠ¢<âŠ¸âˆ¾â‹ˆ)Ëœğ•©F ints}_fp 0Â¨xm â† L ints.sm
    2Ã·Ëœ+Â´âˆ˜â¥Š pm (âŠ£â‰âŠ¸Ã—{ğ•©.hcore + ğ•¨Fğ•©}) ints
  }
#+end_src

If you are receptive and humble, mathematics will lead you by the hand[fn:7]:

#+begin_src bqn :tangle ./bqn/hf.bqn :exports both
  SCFâˆ˜System 1.4632
#+end_src

#+RESULTS:
: Â¯4.22752930421725

Compare the electronic energy with the one computed using the original [[./supp/hf_so/hf_so.html][Fortran]] program. In terms of performance,
running the program with CBQN takes 5 ms,  which is in the same order of magnitude as the original program.
The BQN implementation has 45 LoC, in contrast with the 541 of the Fortran one.

#+begin_export html
<details>
<summary>Potential Energy Surface</summary>
#+end_export

The system's [[https://en.wikipedia.org/wiki/Potential_energy_surface][PES]] will be presented here. For now, itâ€™s (you guessed it) the classic Lennard-Jones:

#+NAME: attr_wrap
#+BEGIN_SRC sh :var data="" :results output :exports none :tangle no
  echo "<br/>"
  echo '<div style="display: flex; justify-content: center; width: 100%;">'
  echo '<div style="width: 40%;">'
  echo "$data"
  echo "</div>"
  echo "</div>"
#+END_SRC

#+begin_src bqn
(âŠ¢â‰SCFâŠâˆâˆ˜SystemÂ¨) â†•âˆ˜âŒˆâŒ¾((0.1+1eÂ¯2Ã—âŠ¢)â¼)3.5
#+end_src

#+RESULTS:
: â”Œâ”€                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
: â•µ                 0.1 0.11 0.12000000000000001 0.13 0.14 0.15000000000000002               0.16              0.17 0.18 0.19                 0.2 0.21000000000000002 0.22 0.23 0.24000000000000002 0.25               0.26               0.27               0.28 0.29000000000000004 0.30000000000000004               0.31 0.32               0.33 0.33999999999999997 0.35               0.36                0.37 0.38 0.39                0.4 0.41000000000000003 0.42000000000000004 0.43000000000000005 0.44000000000000006 0.45000000000000007 0.45999999999999996               0.47               0.48 0.49                0.5               0.51               0.52 0.53               0.54               0.55 0.56 0.5700000000000001 0.58 0.59 0.6 0.61               0.62               0.63               0.64               0.65                0.66                0.67 0.6799999999999999               0.69               0.7 0.71 0.72               0.73                0.74 0.75 0.76               0.77               0.78 0.79                0.8 0.8099999999999999               0.82 0.83                0.84               0.85 0.86               0.87               0.88 0.89 0.9               0.91               0.92                0.93               0.94 0.95              0.96                0.97 0.98 0.99 1               1.01                1.02                1.03               1.04 1.05 1.06               1.07                1.08               1.09 1.1                1.11               1.12 1.1300000000000001 1.1400000000000001 1.1500000000000001 1.1600000000000001 1.1700000000000002 1.1800000000000002 1.1900000000000002 1.2000000000000002 1.2100000000000002 1.2200000000000002 1.2300000000000002 1.2400000000000002 1.2500000000000002               1.26               1.27 1.28                1.29 1.3               1.31                1.32               1.33               1.34               1.35 1.36                1.37 1.3800000000000001 1.3900000000000001  1.4000000000000001 1.4100000000000001 1.4200000000000002 1.4300000000000002 1.4400000000000002 1.4500000000000002  1.4600000000000002 1.4700000000000002 1.4800000000000002 1.4900000000000002 1.5000000000000002               1.51 1.52               1.53               1.54 1.55               1.56 1.57 1.58             1.59                1.6 1.61               1.62 1.6300000000000001 1.6400000000000001 1.6500000000000001 1.6600000000000001 1.6700000000000002 1.6800000000000002 1.6900000000000002  1.7000000000000002 1.7100000000000002 1.7200000000000002  1.7300000000000002  1.7400000000000002  1.7500000000000002  1.7600000000000002 1.77                1.78                1.79 1.8 1.81 1.82 1.83               1.84                1.85                1.86                1.87 1.8800000000000001  1.8900000000000001 1.9000000000000001 1.9100000000000001 1.9200000000000002 1.9300000000000002  1.9400000000000002 1.9500000000000002 1.9600000000000002 1.9700000000000002 1.9800000000000002 1.9900000000000002                   2 2.0100000000000002               2.02 2.03                2.04               2.05 2.06               2.07               2.08                2.09 2.1 2.1100000000000003                2.12 2.1300000000000003                2.14                2.15              2.16                2.17 2.18 2.19                 2.2 2.21                2.22 2.23 2.24                2.25  2.2600000000000002                2.27 2.2800000000000002                2.29  2.3000000000000003                2.31 2.3200000000000003               2.33  2.3400000000000003                2.35  2.3600000000000003                2.37  2.3800000000000003               2.39 2.4000000000000004               2.41              2.42 2.43 2.44 2.45               2.46 2.47                2.48                2.49 2.5 2.5100000000000002 2.52 2.5300000000000002                2.54 2.5500000000000003                2.56  2.5700000000000003 2.58 2.5900000000000003                 2.6 2.6100000000000003                2.62 2.6300000000000003                2.64  2.6500000000000004               2.66                2.67               2.68 2.69                2.7                2.71                2.72               2.73               2.74               2.75 2.7600000000000002               2.77 2.7800000000000002               2.79 2.8000000000000003 2.81 2.8200000000000003 2.83  2.8400000000000003 2.85  2.8600000000000003               2.87  2.8800000000000003               2.89 2.9000000000000004 2.91 2.92                2.93 2.94                2.95               2.96 2.97                2.98                2.99                   3 3.0100000000000002               3.02  3.0300000000000002 3.04 3.0500000000000003                3.06  3.0700000000000003                3.08 3.0900000000000003 3.1 3.1100000000000003                3.12  3.1300000000000003               3.14 3.1500000000000004                3.16 3.1700000000000004 3.18              3.19 3.2               3.21               3.22               3.23                3.24 3.25 3.2600000000000002 3.27  3.2800000000000002                3.29  3.3000000000000003               3.31 3.3200000000000003                3.33  3.3400000000000003 3.35 3.3600000000000003                3.37  3.3800000000000003 3.39 3.4000000000000004                3.41 3.4200000000000004               3.43 3.44                3.45                3.46 3.47 3.48                3.49  
:   Â¯6.8229022200138765    âˆ  Â¯6.773928698296715    âˆ    âˆ                   âˆ Â¯6.661355708109435 Â¯6.63107537549687    âˆ    âˆ Â¯6.5373171655630955                   âˆ    âˆ    âˆ  Â¯6.409582881028582    âˆ Â¯6.346062026176783 Â¯6.314599714308243 Â¯6.283394625606369  Â¯6.252481708165243 Â¯6.2218895830830725 Â¯6.191641198254424    âˆ Â¯6.132242809733374                   âˆ    âˆ Â¯6.046037564725312 Â¯6.0180903456216175    âˆ    âˆ Â¯5.936596059450954  Â¯5.910198857192711                   âˆ  Â¯5.858517376134579  Â¯5.833217632152398  Â¯5.808267440126737                   âˆ Â¯5.759380622050888 Â¯5.735426103421678    âˆ Â¯5.688449964978548 Â¯5.665410613761239 Â¯5.642658831281965    âˆ Â¯5.597984442811525 Â¯5.576045670502101    âˆ  Â¯5.53292654949736    âˆ    âˆ   âˆ    âˆ Â¯5.429227911978138 Â¯5.409140504821583 Â¯5.389257372019014 Â¯5.369573434717422 Â¯5.3500838824774855 Â¯5.3307841643042035 Â¯5.311669979048495 Â¯5.292737265328638 Â¯5.27398219110185    âˆ    âˆ Â¯5.218747700232141 Â¯5.2006690748479825    âˆ    âˆ Â¯5.147391884770528 Â¯5.129943949025151    âˆ Â¯5.095501063177446                  âˆ Â¯5.061648574649203    âˆ Â¯5.0283716605837725 Â¯5.011944815829682    âˆ Â¯4.979506583144451 Â¯4.963492291008778    âˆ   âˆ Â¯4.916252472869603 Â¯4.900769320280448 Â¯4.8854158774752925 Â¯4.870190984668918    âˆ Â¯4.84012234683062 Â¯4.8252764090006695    âˆ    âˆ âˆ Â¯4.767123795932433 Â¯4.7528882648891955 Â¯4.7387717536956515 Â¯4.724773261334123    âˆ    âˆ Â¯4.683475966550175 Â¯4.6699396392066514 Â¯4.656516393608193   âˆ Â¯4.6300052357545685 Â¯4.616915372574437 Â¯4.603934689080876 Â¯4.591062214522781 Â¯4.578296980148897 Â¯4.565638019382833 Â¯4.553084368056322                  âˆ  Â¯4.52828915082979 Â¯4.516045671383258 Â¯4.503903675029328 Â¯4.491862214614535 Â¯4.479920347578047                  âˆ Â¯4.456331648957169 Â¯4.444682959120971 Â¯4.433130147027492    âˆ Â¯4.4103085108534525   âˆ Â¯4.387859524014177 Â¯4.3767725533480775 Â¯4.365776096986733 Â¯4.354869290394829 Â¯4.344051278279978    âˆ Â¯4.3226782640824295 Â¯4.312121599869356 Â¯4.301650406264386 Â¯4.2912638776044965                  âˆ  Â¯4.27074164464937 Â¯4.260604381480139                  âˆ Â¯4.240573744231231 Â¯4.2306788750893585 Â¯4.220863326614497                  âˆ                  âˆ Â¯4.191885447418072 Â¯4.182380075928863    âˆ Â¯4.163596121878875 Â¯4.154316209873675    âˆ Â¯4.135977265130743    âˆ    âˆ Â¯4.1090115749485 Â¯4.100165276055033    âˆ Â¯4.082682484206789 Â¯4.074044822974511                  âˆ Â¯4.056974107445151 Â¯4.048539930473078                  âˆ Â¯4.031871184361146 Â¯4.023635533917624 Â¯4.0154649883687785 Â¯4.007359022762634 Â¯3.999317118034434 Â¯3.9913387607973867 Â¯3.9834234431399884 Â¯3.9755706624303175 Â¯3.9677799211277778    âˆ Â¯3.9523825909632038 Â¯3.9447750308922327   âˆ    âˆ    âˆ    âˆ Â¯3.907629249218127 Â¯3.9003752304787778 Â¯3.8931785201449687 Â¯3.8860386665980338 Â¯3.878955221696322 Â¯3.8719277406942894 Â¯3.864955782169136                  âˆ                  âˆ Â¯3.844368675726893 Â¯3.8376144571640807                  âˆ Â¯3.824265686769211 Â¯3.817670292643505 Â¯3.811127002668631  Â¯3.80463540311355 Â¯3.7981950831806315 Â¯3.791805634993464 Â¯3.785466653588111    âˆ Â¯3.7729384857977526 Â¯3.766748504008826    âˆ Â¯3.754514777916164 Â¯3.748470255646885 Â¯3.7424734467770797   âˆ                  âˆ Â¯3.7247654983622525                  âˆ Â¯3.7131918471153877 Â¯3.7074734060399948 Â¯3.70180006833964 Â¯3.6961714729808044    âˆ    âˆ Â¯3.6795505752200532    âˆ Â¯3.6686872033296836    âˆ    âˆ Â¯3.6527110919995014 Â¯3.6474694219839825 Â¯3.6422690474776673                  âˆ Â¯3.6319908742563167 Â¯3.6269124274619355 Â¯3.6218739799865975 Â¯3.616875215005575 Â¯3.611915818545654 Â¯3.6069954794633827 Â¯3.6021138894216502 Â¯3.5972707428646875 Â¯3.5924657369915582 Â¯3.5876985717281866 Â¯3.582968949698013 Â¯3.578276576191313 Â¯3.573621159133327 Â¯3.56900240905121    âˆ    âˆ    âˆ Â¯3.550888378155818    âˆ Â¯3.5420440236285344 Â¯3.5376740483125984   âˆ                  âˆ    âˆ                  âˆ Â¯3.5163354599985963                  âˆ Â¯3.5080337208239403 Â¯3.5039318969535413    âˆ Â¯3.495825075979037 Â¯3.4918195788380952                  âˆ Â¯3.4839031752716183                  âˆ Â¯3.4761112659449926 Â¯3.4722613932160864 Â¯3.468441923387202 Â¯3.4646526197471683 Â¯3.460893247209319    âˆ Â¯3.453463363021109 Â¯3.4497923890307454 Â¯3.4461504214018603 Â¯3.442537232699054 Â¯3.438952596929522 Â¯3.435396289516098                  âˆ Â¯3.428367768372636                  âˆ Â¯3.421449900004786                  âˆ    âˆ                  âˆ    âˆ Â¯3.4046279127318213    âˆ Â¯3.3980836947590376 Â¯3.394850293596228 Â¯3.3916424197172956 Â¯3.388459866108508                  âˆ    âˆ    âˆ Â¯3.3759787535514967    âˆ Â¯3.3698848188786585 Â¯3.366873804718179    âˆ Â¯3.3609226917101913 Â¯3.3579821996494834 Â¯3.3550648235105784                  âˆ Â¯3.349298644212927 Â¯3.3464494562916225    âˆ                  âˆ Â¯3.3380352128907966 Â¯3.3352742761677607 Â¯3.3325349330773286                  âˆ   âˆ Â¯3.324444615102523 Â¯3.3217898012854308 Â¯3.3191556637193447 Â¯3.316542022081746 Â¯3.313948697105839 Â¯3.3113755105828866                  âˆ    âˆ Â¯3.30377501556912   âˆ Â¯3.298805491849313 Â¯3.296349453245512 Â¯3.293912335486151 Â¯3.2914939689270564    âˆ                  âˆ    âˆ Â¯3.2820046598195645 Â¯3.2796775426513247 Â¯3.2773681816916023 Â¯3.275076414948146                  âˆ Â¯3.2705450216658534 Â¯3.2683050766748414    âˆ  Â¯3.26387590219679 Â¯3.2616863609338482 Â¯3.2595133109991985    âˆ Â¯3.255216073862965 Â¯3.2530915838386516 Â¯3.250982979499567 Â¯3.248890112242583    âˆ Â¯3.2447510001868545 Â¯3.2427044638076734    âˆ    âˆ Â¯3.2366552074215234  
:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     â”˜

#+begin_src bqn :results html :exports both :tangle ./bqn/hf.bqn :post attr_wrap(data=*this*)
  )r Setplot "line" â‹„ â€¢OutÂ¨ PlotÂ´ (âŠ¢â‹ˆSCFâŠâˆâˆ˜SystemÂ¨) â†•âˆ˜âŒˆâŒ¾((0.1+1eÂ¯2Ã—âŠ¢)â¼)3.5
#+end_src

#+RESULTS:
#+begin_export html
<br/>
<div style="display: flex; justify-content: center; width: 100%;">
<div style="width: 40%;">
Error: â€¢Plot: ğ•¨ and ğ•© must consist of rows of numbers
/home/loren/Documents/Arbeit/REPOS/blog/bqn-utils/plots.bqn:25:
    "â€¢Plot: ğ•¨ and ğ•© must consist of rows of numbers" ! ğ•¨ âŠ¢âŠ˜âˆ§â—‹((1â‰¤=)â—¶âŸ¨0,âˆ§Â´âˆ˜â¥Š@âŠ¸>âŸ©) ğ•©
                                                     ^
/home/loren/Documents/Arbeit/REPOS/blog/bqn-utils/plots.bqn:31:
    ğ•¨ (2â‰¤âŒŠÂ´d)â—¶âŸ¨PairâŠ£"â€¢Plot: invalid depth mixing"!Â·âˆ§Â´1=dË™, âˆ¾âˆ˜â¥Šğ•ŠÂ¨âŸ© ğ•©
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/loren/Documents/Arbeit/REPOS/blog/bqn-utils/plots.bqn:34:
    xy â† 1e300 (âŠ£-âŠ¸âŒˆâŒŠ) â‰> ğ•¨ PairRec ğ•©   # organize and clip
                            ^^^^^^^
at Setplot "line" â‹„ â€¢OutÂ¨ PlotÂ´ (âŠ¢â‹ˆSCFâŠ@âˆ˜SystemÂ¨) â†•âˆ˜âŒˆâŒ¾((0.1+1eÂ¯2Ã—âŠ¢)â¼)3.5
                          ^^^^^
</div>
</div>
#+end_export

#+begin_export html
</details>
#+end_export

[fn:1] Recasting of the [[https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation#Time-independent_equation][TISE]] into a set of coupled integro-differential equations. Derived by optimizing
the expectation value of the energy subject to normalization constraints, then discretizing it using a suitable
basis set.
[fn:2] It may not look like much, but helonium was the very [[https://www.scientificamerican.com/article/the-first-molecule-in-the-universe/][first molecule]] formed in the universe.
[fn:3] This program can compute the Hartree-Fock energy of any two-electron diatomic molecule.
[fn:4] STO: functions of the form \(r^le^{-\zeta r}Y_l^m(\theta, \phi)\). For \(1s\) orbitals the
spherical harmonics integrate out to 1.
[fn:5] STO-nG: a non-linear least-squares fit of an STO as a weighted sum of n Gaussians.
[fn:6] See for example [[https://arxiv.org/abs/2007.12057][arXiv:2007.12057]].
[fn:7] Paul A.M. Dirac, 27 November, 1975

#+BEGIN_EXPORT html
  <div style="text-align: center; font-size: 2em; padding: 20px 0;">
    <a href="https://panadestein.github.io/blog/" style="text-decoration: none;">âŠ‘âˆ˜âˆ</a>
  </div>
#+END_EXPORT
