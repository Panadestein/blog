# -*- eval: (face-remap-add-relative 'default '(:family "BQN386 Unicode" :height 180)); -*-
#+TITLE: Helonium's Hartree-Fock program
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="assets/style.css"/>

** Exordium

We will implement the Hartree-Fock[fn:1] program from the classic [[https://store.doverpublications.com/products/9780486691862][Szabo-Ostlund]] text,
a staple in quantum chemistry. If you have any experience in the field, chances are you know it well.
If you don't, the BQN implementation will take you only a few cognitive units: the coarse mathematical
description involves basis sets, the calculation of electronic integrals, and the self-consistent
optimization of the Fock matrix. Using this program, we will compute the energy of the HeH\(^+\) molecule[fn:2].

First we will import the required BQN system values and define some auxiliary functions:

#+begin_src bqn :results none :tangle ./bqn/hf.bqn
  Sinâ€¿Cosâ€¿Tanâ€¿Erf â† â€¢math
  F â† (Ï€Ã·4)âŠ¸Ã·Ã—âŸœErfâ—‹âˆšâŠ¢
  G â† â‹†âŸœ0.75Ã—Â·â‹†-âŠ¸Ã—âŸœ(Ã—Ëœ)
#+end_src

** STO-3G

Basis sets are used to transform the PDEs into linear algebra problems. Physical intuition suggests that
Slater type orbitals[fn:3] should be a good choice, but the computation of the integrals is a lot easier
if we approximate them with Gaussian functions[fn:4], three in our case. Since our molecule has only \(1s\)
orbitals:

#+begin_src bqn :results none :tangle ./bqn/hf.bqn
  STO3G â† {
    câ€¿e â† âŸ¨0.316894â€¿0.381531â€¿0.109991, 0.109818â€¿0.405771â€¿2.22766âŸ©
    cÃ—(eÃ—ğ•¨)Gğ•©
  }
#+end_src

** Electronic integrals

Constructing the integrals' tensor is complicated[fn:5] and is the main reason for the poor scaling
of electronic structure methods. For \(1s\) orbitals, some integrals are analytical (S, T)
while others lack a closed-form solution (V, ERI):

#+begin_src bqn :tangle ./bqn/hf.bqn 
  S â† {aâ€¿bğ•Šğ•©: (1.5â‹†ËœÏ€Ã·a+b) Ã— â‹†-ğ•©Ã—a(Ã—Ã·+)b}
  T â† {aâ€¿bğ•Šğ•©: f â† a(Ã—Ã·+)b â‹„ Ã—Â´âŸ¨1.5â‹†ËœÏ€Ã·a+b, (3Ã—f)-2Ã—ğ•©Ã—Ã—Ëœf, â‹†-ğ•©Ã—fâŸ©}
  V â† {aâ€¿bâ€¿zğ•Šrâ€¿s: Ã—Â´âŸ¨-2Ã—zÃ—Ï€Ã·a+b, F sÃ—a+b, â‹†-rÃ—a(Ã—Ã·+)bâŸ©}
  ERI â† {aâ€¿bâ€¿câ€¿dğ•Šrâ€¿sâ€¿t:
    f â† (a+b)Ã—(c+d)Ã—âˆša+b+c+d
    gâ€¿h â† aâ€¿bâ‹ˆâ—‹((Ã—Ã·+)Â´)câ€¿d 
    Ã—Â´âŸ¨2Ã·fÃ—Ï€â‹†5Ã·2, F fâ‹†t, â‹†-+Â´râ€¿sÃ—gâ€¿hâŸ©
  }
#+end_src

#+begin_export html
<br/>
<details>
<summary>Derivation strategy</summary>
#+end_export

We need to compute the overlap (S), kinetic energy (T), nuclear attraction (V), and four-center (ERI) integrals.
Crucially, the product of two Gaussians at different centers is proportional to a Gaussian at a scaled center.
This property, combined with the Laplacian of a Gaussian, readily yields S and T. The remaining
two sets are more complex: we combine the Gaussians as before, then transform to reciprocal space where
the delta distribution arises and simplifies the problem to this integration by reduction:

\begin{equation*}
  I(x) = \int_0^{\infty}{{{e^ {- a\,k^2 }\,\sin \left(k\,x\right)}\over{k}}\;dk} \sim \text{Erf}(x)
\end{equation*}

#+begin_export html
</details>
#+end_export

#+begin_src bqn :tangle ./bqn/hf.bqn
  I â† {e1â€¿e2â€¿z1â€¿z2ğ•Šğ•©:
    e1â€¿e2 STO3GâŒœ ğ•©â€¿
    Sâ€¿Tâ€¿Vâ€¿ERI {ğ•ğ•©}     
  }
#+end_src

** SCF

Compare the electronic energy with the one computed using the original [[./supp/hf_so/hf_so.html][F66]] program.

[fn:1] Recasting of the [[https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation#Time-independent_equation][TISE]] into a set of coupled integro-differential equations. Derived by optimizing
the expectation value of the energy subject to normalization constraints, then discretizing it using a suitable
basis set.
[fn:2] The program should work for any two-electron system. It may not look like much, but helonium was the
very [[https://www.scientificamerican.com/article/the-first-molecule-in-the-universe/][first molecule]] formed in the universe.
[fn:3] STO: functions of the form \(r^le^{-\zeta r}Y_l^m(\theta, \phi)\). For \(1s\) orbitals the
spherical harmonics integrate out to 1.
[fn:4] STO-nG: a non-linear least-squares fit of an STO as a weighted sum of n Gaussians.
[fn:5] See for example [[https://arxiv.org/abs/2007.12057][arXiv:2007.12057]].
