# -*- eval: (face-remap-add-relative 'default '(:family "BQN386 Unicode" :height 180)); -*-
#+TITLE: Helonium's Hartree-Fock program
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="assets/style.css"/>

** Exordium

We will implement the Hartree-Fock[fn:1] program from the classic [[https://store.doverpublications.com/products/9780486691862][Szabo-Ostlund]] text,
a staple in quantum chemistry. If you have any experience in the field, chances are you know it well.
If you don't, the BQN implementation will take you only a few cognitive units: the coarse mathematical
description involves basis sets, the calculation of electronic integrals, and the self-consistent
optimization of the Fock matrix. Using this program, we will compute the energy of the HeH\(^+\) molecule[fn:2].

First we will import the required BQN system values and define some auxiliary functions:

#+begin_src bqn :results none :tangle ./bqn/hf.bqn
  Sin‿Cos‿Tan‿Erf ← •math
  F ← (π÷4)⊸÷×⟜Erf○√⊢
#+end_src

** STO-3G

Basis sets are used to transform the PDEs into linear algebra problems. Physical intuition suggests that
Slater type orbitals[fn:3] should be a good choice, but the computation of the integrals is a lot easier
if we approximate them with Gaussian functions[fn:4], three in our case. Since our molecule has only \(1s\)
orbitals:

#+begin_src bqn :tangle ./bqn/hf.bqn
  STO3G ← {
    e ← 0.109818‿0.405771‿2.22766 × ×˜𝕨
    c ← 0.444635‿0.535328‿0.154329 × (2×e÷π)⋆3÷4
    c⋈⋆-e××˜𝕩
  }
#+end_src

#+RESULTS:
: (function block)

** Electronic integrals

Constructing the integrals' tensor is complicated[fn:5] and is the main reason for the poor scaling
of electronic structure methods. The \(1s\) orbitals are the simplest case, and here two types of integrals
are analytical (S, T) while the rest already lacks a closed-form solution (V, ERI):

#+begin_src bqn :tangle ./bqn/hf.bqn 
  S ← {a‿b𝕊𝕩: (1.5⋆˜π÷a+b) × ⋆-𝕩×a(×÷+)b}
  T ← {a‿b𝕊𝕩: f ← a(×÷+)b ⋄ ×´⟨1.5⋆˜π÷a+b, (3×f)-2×𝕩××˜f, ⋆-𝕩×f⟩}
  V ← {a‿b‿z𝕊r‿s: ×´⟨-2×z×π÷a+b, F s×a+b, ⋆-r×a(×÷+)b⟩}
  ERI ← {a‿b‿c‿d𝕊r‿s‿t:
    f ← (a+b)×(c+d)×√a+b+c+d
    g‿h ← a‿b⋈○((×÷+)´)c‿d 
    ×´⟨2÷f×π⋆5÷2, F f⋆t, ⋆-+´r‿s×g‿h⟩
  }
#+end_src

#+RESULTS:
: (function block)

#+begin_export html
<br/>
<details>
<summary>Derivation strategy</summary>
#+end_export

We need to compute the overlap (S), kinetic energy (T), nuclear attraction (V), and four-center (ERI) integrals.
Crucially, the product of two Gaussians at different centers is proportional to a Gaussian at a scaled center.
This property, combined with the Laplacian of a Gaussian, readily yields S and T. The remaining
two sets are more complex: we combine the Gaussians as before, then transform to reciprocal space where
the delta distribution arises and simplifies the problem to this integration by reduction:

\begin{equation*}
  I(x) = \int_0^{\infty}{{{e^ {- a\,k^2 }\,\sin \left(k\,x\right)}\over{k}}\;dk} \sim \text{Erf}(x)
\end{equation*}

#+begin_export html
</details>
#+end_export

#+begin_src bqn :tangle ./bqn/hf.bqn
  I ← {e1‿e2‿z1‿z2𝕊𝕩:
    e1‿e2 STO3G⌜ 𝕩
  }
  1‿5‿1‿1 I 5
#+end_src

#+RESULTS:
: ┌─                                                                                                                                                                                                                                                           
: · ⟨ ⟨ 0.0604531430684543 0.19397278694452924 0.20055999696037574 ⟩ ⟨ 0.06421939571324288 3.930043383859457e¯5 6.5086191712493175e¯25 ⟩ ⟩ ⟨ ⟨ 0.6758866867729201 2.168681686965255 2.242328933852757 ⟩ ⟨ 1.5547313879185297e¯30 7.243252329697942e¯111 0 ⟩ ⟩  
:                                                                                                                                                                                                                                                             ┘

** SCF

Compare the electronic energy with the one computed using the original [[./supp/hf_so/hf_so.html][F66]] program.

[fn:1] Recasting of the [[https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation#Time-independent_equation][TISE]] into a set of coupled integro-differential equations. Derived by optimizing
the expectation value of the energy subject to normalization constraints, then discretizing it using a suitable
basis set.
[fn:2] The program should work for any two-electron system. It may not look like much, but helonium was the
very [[https://www.scientificamerican.com/article/the-first-molecule-in-the-universe/][first molecule]] formed in the universe.
[fn:3] STO: functions of the form \(r^le^{-\zeta r}Y_l^m(\theta, \phi)\). For \(1s\) orbitals the
spherical harmonics integrate out to 1.
[fn:4] STO-nG: a non-linear least-squares fit of an STO as a weighted sum of n Gaussians.
[fn:5] See for example [[https://arxiv.org/abs/2007.12057][arXiv:2007.12057]].
