Setplotâ€¿Plot â† â€¢Import "../bqn-utils/plots.bqn"
U â† 0.5-Ëœâ€¢rand.RangeâŸœ0
M â† +Ëâˆ˜Ã—â‰1â€¿âˆ
RMS â† âˆšâ‰ âˆ˜âŠ¢Ã·ËœÂ·+Â´Ã—Ëœâˆ˜-

Minn â† {rtâ€¿lyğ•Šdat:
  Aâ€¿DA â† âŸ¨1Ã·1+â‹†âˆ˜-, âŠ¢Ã—1âŠ¸-âŸ©
  BP â† {fsâ€¿tsâ€¿weğ•Šğ•©: do â† (<-âŸœtsÃ—DA)âŠ‘âŠ‘hxâ€¿tx â† Â¯1(â†‘â‹ˆâ†“)ğ•©
    (fs<âŠ¸âˆ¾tx)Ã—âŒœËœÂ¨doâˆ¾Ëœ{dğ•Šwâ€¿z: z DAâŠ¸Ã—d MËœâ‰w}`ËœâŸœdoâŒ¾âŒ½txâ‹ˆÂ¨Ëœ1â†“we
  }
  FP â† {zğ•Šbiâ€¿we: A bi+we M z}`âŸœ(â‹ˆÂ¨Â´)
  nn â† dat{ğ•¨ğ•Šbiâ€¿we: fsâ€¿ts â† ğ•¨(â†‘â‹ˆâ†“)ËœâŠ‘ly
    biâ‹ˆwe-rtÃ— fsâ€¿tsâ€¿we BP fs<âŠ¸FPğ•©}ËËœ(Uâš‡1-âŸœ1âˆ˜â‰ â‹ˆÂ·<âˆ˜âŒ½Ë˜2âŠ¸â†•)ly
  E â‡ âŠ¢Â´<âŠ¸FPâŸœnn
}

neqâ€¿ntrâ€¿nteâ€¿e â† 600â€¿100â€¿50â€¿100
I â† {â†•âˆ˜âŒˆâŒ¾((2.8+ğ•©Ã—âŠ¢)â¼)4}
L â† {ğ•¨(âŠ£Ã—1âŠ¸-Ã—âŠ¢)âŸ((neq-ğ•©)+â†•ğ•©)â€¢rand.Range 0}
te â† âˆ¾{ğ•©âˆ¾Ë˜âŠâ‰2â†•ğ•©L nte}Â¨I (0.004-Ëœ10âŠ¸â‹†Ã·Ëœâˆš)2
tr â† â€¢rand.Dealâˆ˜â‰ âŠ¸âŠâŠ¸âˆ¾âŸ(e-1)Ëœâˆ¾{ğ•©âˆ¾Ë˜2â†•ğ•©L ntr}Â¨I 0.1
â‰ Â¨trâ€¿te

lm â† 0.001â€¿âŸ¨2, 300, 1âŸ© Minn td
(âŠ¢RMSâŸœâˆ¾Â·lm.EÂ¨âŠ£)Ëâ‰td

)r Setplot "scatter" â‹„ â€¢OutÂ¨ PlotËâ‰(âŠ‘âˆ¾lm.E)Ë˜te
