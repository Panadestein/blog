Setplotâ€¿Plot â† â€¢Import "../bqn-utils/plots.bqn"
U â† 0.5-Ëœâ€¢rand.RangeâŸœ0
M â† +Ëâˆ˜Ã—â‰1â€¿âˆ

Minn â† {râ€¿lğ•Šğ•©:
  Aâ€¿DA â† âŸ¨1Ã·1+â‹†âˆ˜-, âŠ¢Ã—1âŠ¸-âŸ©
  BP â† {tsâ€¿wğ•Šğ•©:
    do â† (-âŸœtsÃ—DA)âŠ¢Â´ğ•©
    ğ•©Ã—âŒœÂ¨doâˆ¾(âŠ‘do){dğ•Šwâ€¿ly: (DA ly)Ã—d M w}`â‹ˆÂ¨Â´(1â†“âŒ½)Â¨wâ€¿ğ•©
  }
  FP â† {ğ•¨ğ•Šbâ€¿w: AÂ¨b+ğ•¨M w}`âŸœ(â‹ˆÂ¨Â´)
  nn â† ğ•©{fsâ€¿tsğ•Šbâ€¿w: bâ‹ˆw-rÃ— tsâ€¿w BP fs FPğ•©}Â´Ëœ(Uâš‡1-âŸœ1âˆ˜â‰ â‹ˆÂ·<Ë˜2âŠ¸â†•)l
  E â‡ âŠ¢Â´FPâŸœnn  
}

nâ€¿riâ€¿rfâ€¿dr â† 1000â€¿2.8â€¿4â€¿0.001
@ âŠ£ td â† {ğ•©(âŠ£âˆ¾(âŠ£Ã—1âŠ¸-Ã—âŠ¢)âŸn)Â¨0 â€¢rand.RangeËœâ‰ ğ•©} â†•âˆ˜âŒˆâŒ¾((ri+drÃ—âŠ¢)â¼)rf

lm â† 0.01â€¿âŸ¨1, 10, 1âŸ© Minn td
â‰ lm.E 2.9

)r Setplot "scatter" â‹„ â€¢OutÂ¨ PlotÂ´  m {nsâ†â‰ âŠ‘ğ•¨ â‹„ (>ğ•¨)â‹ˆËœâˆ˜â€¿nsâ¥Šns/ğ•©} r
