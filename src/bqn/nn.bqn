Setplotâ€¿Plot â† â€¢Import "../bqn-utils/plots.bqn"
U â† 0.5-Ëœâ€¢rand.RangeâŸœ0
M â† +Ëâˆ˜Ã—â‰1â€¿âˆ

Minn â† {rtâ€¿lyğ•Šdat:
  Aâ€¿DA â† âŸ¨1Ã·1+â‹†âˆ˜-, âŠ¢Ã—1âŠ¸-âŸ©
  BP â† {fsâ€¿tsâ€¿weğ•Šğ•©: 
    do â† <(-âŸœtsÃ—DA)âŠ‘hxâ€¿tx â† 1(â†‘â‹ˆâ†“)âŒ½ğ•©
    (fs<âŠ¸âˆ¾tx)Ã—âŒœËœÂ¨âŒ½doâˆ¾do{dğ•Šwâ€¿z: z DAâŠ¸Ã—d MËœâ‰w}`â‹ˆÂ¨Â´txâ‹ˆËœ1â†“we
  }
  FP â† {zğ•Šbâ€¿we: weâ€¿zâ‹„AÂ¨b+we M z}`âŸœ(â‹ˆÂ¨Â´)
  E â‡ FP{âŠ¢Â´ğ•©ğ”½ dat{ğ•¨ğ•Šbiâ€¿we: fsâ€¿ts â† ğ•¨(â†‘â‹ˆâ†“)ËœâŠ‘ly
    biâ‹ˆwe-rtÃ— fsâ€¿tsâ€¿we BP fs<âŠ¸FPğ•©}ËËœ(Uâš‡1-âŸœ1âˆ˜â‰ â‹ˆÂ·<âˆ˜âŒ½Ë˜2âŠ¸â†•)ly}
}

nâ€¿riâ€¿rfâ€¿dr â† 10â€¿2.8â€¿4â€¿0.1
â‰ td â† âˆ¾{ğ•©âˆ¾Ë˜2â†•ğ•©(âŠ£Ã—1âŠ¸-Ã—âŠ¢)âŸ(â†•n)â€¢rand.Range 0}Â¨â†•âˆ˜âŒˆâŒ¾((ri+drÃ—âŠ¢)â¼)rf

lm â† 0.01â€¿âŸ¨2, 5, 1âŸ© Minn td
â‰¡lm.E 2.85

)r Setplot "scatter" â‹„ â€¢OutÂ¨ PlotÂ´  m {nsâ†â‰ âŠ‘ğ•¨ â‹„ (>ğ•¨)â‹ˆËœâˆ˜â€¿nsâ¥Šns/ğ•©} r
