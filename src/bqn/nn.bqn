Setplotâ€¿Plot â† â€¢Import "../bqn-utils/plots.bqn"
U â† 0.5-Ëœâ€¢rand.RangeâŸœ0
M â† +Ëâˆ˜Ã—â‰1â€¿âˆ

Minn â† {rtâ€¿lyğ•Šğ•©:
  Aâ€¿DA â† âŸ¨1Ã·1+â‹†âˆ˜-, âŠ¢Ã—1âŠ¸-âŸ©
  BP â† {tsâ€¿weğ•Šğ•©:
    do â† <(-âŸœtsÃ—DA)âŠ¢Â´ğ•©
    âŒ½ğ•©Ã—âŒœÂ¨doâˆ¾do{dğ•Šwâ€¿z: (DA z)Ã—d MËœâ‰w}`â‹ˆÂ¨Â´(1â†“âŒ½)Â¨weâ€¿ğ•©
  }
  FP â† {zğ•Šbâ€¿we: AÂ¨b+z M we}`âŸœ(â‹ˆÂ¨Â´)
  nn â† ğ•©{fsâ€¿tsğ•Šbiâ€¿we: biâ‹ˆwe-rtÃ— tsâ€¿we BP fs FPğ•©}Â´Ëœ(Uâš‡1-âŸœ1âˆ˜â‰ â‹ˆÂ·<Ë˜2âŠ¸â†•)ly
  E â‡ âŠ¢Â´FPâŸœnn  
}

nâ€¿riâ€¿rfâ€¿dr â† 1000â€¿2.8â€¿4â€¿0.001
@ âŠ£ td â† {ğ•©(âŠ£âˆ¾(âŠ£Ã—1âŠ¸-Ã—âŠ¢)âŸn)Â¨0 â€¢rand.RangeËœâ‰ ğ•©} â†•âˆ˜âŒˆâŒ¾((ri+drÃ—âŠ¢)â¼)rf

lm â† 0.01â€¿âŸ¨1, 500, 1âŸ© Minn td
lm.E 2.85

)r Setplot "scatter" â‹„ â€¢OutÂ¨ PlotÂ´  m {nsâ†â‰ âŠ‘ğ•¨ â‹„ (>ğ•¨)â‹ˆËœâˆ˜â€¿nsâ¥Šns/ğ•©} r
