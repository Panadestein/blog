Setplotâ€¿Plot â† â€¢Import "../bqn-utils/plots.bqn"
U â† 0.5-Ëœâ€¢rand.RangeâŸœ0
M â† +Ëâˆ˜Ã—â‰1â€¿âˆ

Minn â† {rtâ€¿lyğ•Šdat:
  Aâ€¿DA â† âŸ¨1Ã·1+â‹†âˆ˜-, âŠ¢Ã—1âŠ¸-âŸ©
  BP â† {fsâ€¿tsâ€¿weğ•Šğ•©:
    do â† <(-âŸœtsÃ—DA)âŠ‘âŠ‘hxâ€¿tx â† Â¯1(â†‘â‹ˆâ†“)ğ•©
    (fs<âŠ¸âˆ¾tx)Ã—âŒœËœÂ¨doâˆ¾ËœdoâŠ¸({dğ•Šwâ€¿z: z DAâŠ¸Ã—d MËœâ‰w}`)âŒ¾âŒ½txâ‹ˆÂ¨Ëœ1â†“we
  }
  FP â† {zğ•Šbâ€¿we: AÂ¨b+we M z}`âŸœ(â‹ˆÂ¨Â´)
  nn â† dat{ğ•¨ğ•Šbiâ€¿we: fsâ€¿ts â† ğ•¨(â†‘â‹ˆâ†“)ËœâŠ‘ly
    biâ‹ˆwe-rtÃ— fsâ€¿tsâ€¿we BP fs<âŠ¸FPğ•©}ËËœ(Uâš‡1-âŸœ1âˆ˜â‰ â‹ˆÂ·<âˆ˜âŒ½Ë˜2âŠ¸â†•)ly
  E â‡ âŠ¢Â´<âŠ¸FPâŸœnn
}

nâ€¿eâ€¿riâ€¿rfâ€¿dr â† 200â€¿300â€¿2.8â€¿4â€¿0.1
pd â† âˆ¾{ğ•©âˆ¾Ë˜âŠâ‰2â†•ğ•©(âŠ£Ã—1âŠ¸-Ã—âŠ¢)âŸ(â†•âŒŠ3Ã·Ëœn)â€¢rand.Range 0}Â¨â†•âˆ˜âŒˆâŒ¾((ri+0.01Ã—âŠ¢)â¼)rf
@âŠ£td â† âˆ¾âŸ(e-1)Ëœâˆ¾{ğ•©âˆ¾Ë˜2â†•ğ•©(âŠ£Ã—1âŠ¸-Ã—âŠ¢)âŸ(â†•n)â€¢rand.Range 0}Â¨â†•âˆ˜âŒˆâŒ¾((ri+drÃ—âŠ¢)â¼)rf

lm â† 0.001â€¿âŸ¨2, 300, 1âŸ© Minn td

)r Setplot "scatter" â‹„ â€¢OutÂ¨ PlotËâ‰(âŠ‘âˆ¾lm.E)Ë˜pd
