Setplot‿Plot ← •Import "../bqn-utils/plots.bqn"
U ← 0.5-˜•rand.Range⟜0
M ← +˝∘×⎉1‿∞

Minn ← {rt‿ly𝕊dat:
  A‿DA ← ⟨1÷1+⋆∘-, ⊢×1⊸-⟩
  BP ← {ts‿we𝕊𝕩:
    do ← <(-⟜ts×DA)⊢´𝕩
    𝕩×⌜¨do∾do{d𝕊w‿z: z DA⊸×d M˜⍉w}`⋈¨´1⊸↓¨we⋈⌽𝕩
  }
  FP ← {z𝕊b‿we: we‿z⋄A¨b+we M z}`⟜(⋈¨´)
  E ⇐ FP{⊢´𝕩𝔽 dat{𝕨𝕊bi‿we: fs‿ts ← 𝕨(↑⋈↓)˜⊑ly
    bi⋈we-rt× ts‿we BP fs<⊸FP𝕩}˝˜(U⚇1-⟜1∘≠⋈·<∘⌽˘2⊸↕)ly}
}

n‿ri‿rf‿dr ← 100‿2.8‿4‿0.1
≠td ← ∾{𝕩∾˘2↕𝕩(⊣×1⊸-×⊢)⍟(↕n)•rand.Range 0}¨↕∘⌈⌾((ri+dr×⊢)⁼)rf

lm ← 0.01‿⟨2, 10, 1⟩ Minn td
lm.E 2.85

)r Setplot "scatter" ⋄ •Out¨ Plot´  m {ns←≠⊑𝕨 ⋄ (>𝕨)⋈˜∘‿ns⥊ns/𝕩} r
